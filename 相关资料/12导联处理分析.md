# 十二导联-导联先分开在合并-工作总结

## 1.数据处理

>[数据源地址](http://2018.icbeb.org/Challenge.html)
>
>注：官方给出了TrainSet1，TrainSet2，TrainSet3共6877条记录，分8个心律失常加正常共九个类别。并给出标签数据文件REFERENCE.csv，每条记录最多有三个标签。每条记录采样率为500Hz，时长为6s-60s，每条记录被保存为mat文件格式，A0002.mat具体数据如下：
>
>![1611741237906](C:\Users\13018\AppData\Roaming\Typora\typora-user-images\1611741237906.png)
>
>[参考](https://blog.csdn.net/qq_15746879/article/details/85495496?spm=1001.2014.3001.5502)
>
>注：该博客实现了一个关于12导联的分类实现，但是并未给出数据处理的代码。我着重处理下数据。

### 1.1抽离data数据

将mat数据中的data抽离出来并保存为npy格式，每个mat文件对应一个npy文件。

~~~python
import os
import numpy as np
import scipy.io as sio

mat_path = 'D:/data-set/12leadsECG/TrainingSet/'
npy_path = 'D:/data-set/12leadsECG/TrainingSet/1Data_npy/'

mat_files = os.listdir(mat_path)

for i in range(len(mat_files)):
    file_name = mat_files[i]
    if file_name.endswith('.mat'):
        key_name = file_name[0:5] # 取名字
    else:
        continue
    data = sio.loadmat(mat_path + file_name)
    data = data['ECG'][0]['data'][0]
    np.save(npy_path + key_name + '.npy', data)
~~~

对所有样本的采样数据做个分析：

> [7500, 5000, 5000, 5974, 12500, 7000, 5000, 7588, 8000, 5000, 18000, 8396, 8444, 7870, 12500, 10000, 22498, 25179, 5497, 8500, 5000, 13500, 5000, 11500, 5000, 5500, 5000, 5000, 5000, 6000, 11000, 10000, 5277, 5000, 5500, 15687, 5000, 5284, 5000, 15500, 5000, 6000, 7500, 5000, 5000, 17798, 9521, 5807, 5000, 6773, 5000, 5000, 5000, 5500, 23290, 5400, 8500, 23050, 10000, 5703, 5000, 15149, 6379, 5000, 5500, 5000, 9000, 5000, 20651, 6000, 8500, 8000, 5000, 5000, 5000, 13500, 7500, 5000, 5000, 25270, 6500, 6188, 5000, 28556, 5658, 7500, 6500, 5000, 5000, 5000, 7500, 7068, 5000, 7000, 6000, 17606, 7005, 9000, 10000, 5000, 5000, 5000, 10000, 6211, 6000, 5000, 5000, 6500, 5000, 7500, 15500, 5000, 30000, 5245, 14840, 13500, 5000, 7983, 6000, 5500, 5000, 18500, 5000, 6000, 6000, 7271, 9014, 6125, 7854, 5000, 5000, 5000, 10000, 6500, 5000, 7059, 5000, 6038, 6668, 6327, 13461, 7500, 11000, 5000, 20500, 6999, 8745, 10000, 7500, 8000, 9177, 5492, 7500, 5962, 5000, 6207, 6500, 7732, 17892, 5798, 5000, 5000, 13232, 5000, 5000, 32000, 5000, 5000, 5000, 6500, 7000, 5517, 20780, 5500, 10000, 5000, 17231, 5000, 7000, 5000, 5874, 9000, 21352, 11500, 11000, 6000, 5194, 9000, 5000, 10000, 6187, 5000, 5000, 7366, 5732, 6525, 5000, 5000, 5000, 6056, 7500, 5275, 8266, 14000, 6000, 10000, 5000, 7500, 6500, 7500, 7000, 14000, 10000, 14000, 5000, 5298, 5000, 5000, 5984, 14000, 17301, 10000, 5000, 8000, 6000, 5000, 5000, 5000, 5000, 5687, 7000, 7057, 12000, 6148, 5000, 11000, 7722, 7000, 6006, 4999, 24436, 6000, 7000, 5500, 5000, 5628, 5000, 5500, 5000, 5000, 5000, 8530, 5000, 7000, 17271, 5000, 5000, 5000, 5973, 5000, 10500, 9000, 6795, 5000, 5500, 13000, 6500, 5266, 7816, 5000, 5000, 5000, 14000, 13000, 5000, 5000, 10237, 7000, 5000, 5000, 14422, 7564, 17000, 5000, 10500, 5500, 10000, 5000, 5000, 19500, 7795, 5000, 5876, 7061, 11000, 5500, 8276, 5500, 9000, 6500, 8500, 8000, 16560, 11500, 5500, 10000, 8000, 8316, 6906, 6937, 15209, 9000, 27885, 5000, 5000, 5000, 5000, 5246, 6000, 6592, 7881, 5000, 6091, 10500, 9491, 5000, 5000, 5000, 7000, 5000, 13500, 5000, 7431, 5000, 12500, 6499, 5000, 5668, 6000, 5464, 7248, 5500, 8084, 7500, 11000, 16208, 5000, 5000, 5000, 7000, 5000, 5000, 10000, 6945, 5000, 5000, 5500, 5000, 7677, 5615, 10000, 9000, 5000, 13500, 18813, 7000, 7547, 5000, 7112, 5000, 10000, 6500, 15852, 8500, 10000, 5999, 11507, 6500, 5000, 11500, 7543, 5000, 7500, 5000, 5000, 9500, 11000, 6994, 8500, 5000, 7792, 5000, 5000, 5000, 5000, 5000, 5546, 5000, 5000, 5521, 6000, 5000, 8000, 17500, 5000, 5000, 5000, 5187, 9500, 10500, 7000, 5000, 5000, 12000, 7964, 5000, 7500, 6083, 10000, 7871, 8364, 5000, 6053, 5000, 5000, 8500, 5000, 5000, 5000, 5247, 6053, 5000, 6000, 5000, 5000, 5000, 7000, 6500, 12315, 14000, 19458, 5000, 8017, 5613, 25057, 7008, 5000, 5000, 28000, 6046, 5000, 5603, 8000, 10097, 11000, 5000, 5000, 6500, 7500, 10500, 12000, 5647, 7000, 5000, 6000, 5337, 5446, 5000, 7500, 5500, 5500, 16500, 13884, 5000, 16218, 5000, 17903, 5000, 5424, 5000, 8500, 10000, 6500, 5000, 5500, 8000, 5500, 5903, 10500, 6500, 5000, 6000, 5667, 5208, 12000, 5000, 5000, 10000, 5000, 11000, 6000, 5000, 5000, 5000, 7000, 10477, 16928, 5000, 5000, 5782, 8000, 5000, 6000, 12000, 9823, 8107, 5000, 5000, 5576, 15000, 5000, 5517, 5691, 7500, 5000, 5000, 5000, 5000, 29955, 10000, 6500, 9250, 9958, 10000, 15921, 5000, 5000, 5000, 5000, 5000, 5000, 6014, 9500, 9500, 12500, 10000, 5000, 5000, 10000, 9000, 28500, 15956, 12500, 7000, 7500, 5500, 11000, 5500, 5000, 5000, 5000, 7500, 6265, 5000, 8000, 5000, 6000, 5000, 8500, 5000, 9500, 11804, 5982, 5000, 5000, 5000, 8055, 5000, 5000, 9000, 7148, 21353, 15280, 5000, 7062, 5967, 14500, 16671, 13000, 14049, 10000, 34500, 5000, 5000, 6288, 5000, 5000, 5000, 5802, 18901, 18000, 8000, 5000, 6957, 13000, 12500, 7837, 13163, 5000, 13500, 5500, 8000, 5000, 6452, 6815, 10500, 11000, 8816, 5000, 11500, 5000, 8500, 5523, 11000, 17195, 4999, 15045, 6125, 17848, 10500, 25992, 7000, 7500, 5000, 5500, 7000, 5000, 5000, 20500, 10884, 5000, 5000, 14907, 7500, 25785, 5000, 5000, 6000, 59000, 6407, 7868, 5000, 5000, 11000, 5000, 6000, 5000, 8316, 5000, 5000, 29460, 6000, 5000, 7000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 15273, 5000, 14000, 10000, 7393, 5000, 11786, 15000, 5000, 10000, 5000, 7000, 5000, 13000, 7427, 6903, 9872, 5000, 13026, 12000, 14854, 5000, 5000, 7500, 5000, 5500, 6607, 16500, 12000, 6240, 5000, 6508, 5000, 5000, 8000, 12000, 7000, 8000, 5000, 10000, 5500, 29763, 12000, 6500, 5000, 6500, 5000, 6500, 7808, 5000, 5482, 5000, 16713, 5000, 5497, 5000, 5863, 7500, 5000, 9487, 5325, 17288, 6074, 7000, 5000, 8541, 14000, 19468, 5000, 6000, 5000, 5000, 5000, 18500, 6249, 5000, 7500, 6500, 24500, 7122, 8060, 7000, 7000, 16765, 30000, 10000, 13500, 5247, 5000, 5000, 5000, 5500, 5000, 5000, 5000, 7500, 7000, 26438, 8500, 10000, 5000, 5601, 15711, 5228, 5000, 5000, 5000, 5000, 5000, 5977, 8000, 5000, 8500, 5000, 6000, 5000, 5684, 9246, 5806, 5000, 5000, 6500, 6261, 5000, 8000, 15904, 4500, 10000, 8000, 5000, 5000, 5000, 6960, 5000, 8000, 9000, 5000, 6314, 5000, 5000, 5000, 5000, 6241, 22500, 5000, 5000, 5000, 7287, 5000, 5000, 7500, 6500, 9500, 8000, 8197, 8500, 6402, 7000, 6500, 7000, 5000, 5000, 5213, 5000, 18738, 14000, 7500, 7500, 15000, 10000, 7500, 5000, 16500, 7500, 7500, 7000, 20593, 5000, 5000, 6277, 5000, 7500, 7499, 13500, 5000, 5000, 6500, 12500, 5731, 5000, 5000, 33000, 5000, 26650, 7000, 5000, 8500, 5500, 8500, 5000, 7593, 5644, 5000, 6596, 11000, 8500, 6165, 6000, 9345, 5000, 7000, 5000, 5000, 13373, 5000, 5000, 5467, 9080, 5000, 5000, 8500, 15783, 6000, 5000, 5000, 5604, 5000, 10000, 7000, 7000, 6500, 7994, 11000, 7500, 5000, 5000, 6527, 5367, 5754, 10500, 5000, 9881, 9500, 5000, 5000, 5312, 8500, 8000, 5000, 7384, 11000, 5000, 6000, 8000, 5000, 5000, 5000, 5000, 6548, 7522, 13493, 5000, 12000, 5000, 13000, 5000, 5000, 5000, 5000, 5000, 5787, 5000, 5000, 10500, 5000, 5000, 5000, 12000, 5000, 6500, 7500, 5000, 5000, 6500, 8000, 5000, 5000, 5000, 5965, 5000, 5000, 5000, 5000, 5000, 5601, 10000, 5000, 5000, 7500, 5000, 13048, 6000, 16000, 16622, 5000, 5000, 5000, 10500, 5000, 5000, 5000, 5000, 6213, 13161, 5000, 11000, 5464, 5000, 6677, 7000, 14500, 5000, 7000, 6500, 6635, 8441, 5000, 6617, 12000, 15500, 5000, 6000, 7393, 5000, 5577, 15000, 5000, 10000, 13000, 6054, 5500, 6500, 6823, 5000, 9000, 5000, 5357, 5500, 6000, 17352, 5000, 6500, 10000, 5000, 5000, 5000, 16598, 5000, 6709, 7830, 5000, 8000, 6000, 5000, 5000, 5000, 5000, 14937, 27028, 8500, 5000, 23500, 5000, 6549, 15500, 5000, 5000, 5000, 11000, 15000, 5498, 7500, 10500, 10000, 5500, 6499, 6948, 23956, 5000, 8726, 7500, 13000, 10000, 5500, 5000, 5000, 5000, 5664, 5000, 9000, 15000, 20540, 5000, 8137, 10000, 6500, 8228, 5473, 5554, 5000, 5000, 12000, 6000, 6500, 5000, 5000, 5000, 26000, 5759, 5000, 16087, 9407, 6265, 6500, 6500, 5000, 10500, 5500, 11500, 5000, 5000, 7672, 5616, 5000, 8000, 5000, 6960, 6751, 5777, 5757, 5303, 5000, 7458, 5000, 5000, 5000, 5964, 5000, 6500, 5500, 6000, 13388, 5574, 5000, 5000, 5595, 9000, 7500, 5000, 6414, 5000, 5000, 8000, 11000, 6044, 5500, 5000, 6073, 5000, 6000, 7677, 5000, 8500, 6000, 5000, 8823, 5000, 5000, 14000, 5000, 5000, 8000, 5000, 10000, 11500, 5000, 5000, 5000, 8500, 8000, 5000, 10000, 19000, 5000, 5000, 5972, 7500, 8156, 6000, 5000, 18500, 5000, 5363, 11500, 5000, 5355, 5000, 14786, 11500, 6379, 7000, 5000, 7000, 23500, 5000, 5500, 6499, 5000, 5500, 6500, 5000, 6500, 8500, 7221, 5000, 6333, 6000, 7568, 6395, 5500, 6953, 5000, 11000, 7000, 10000, 5000, 16703, 5963, 5761, 20558, 5000, 5000, 14058, 16320, 5000, 7500, 9000, 5000, 10500, 5000, 12000, 7000, 7500, 6000, 9000, 6000, 5000, 5000, 18907, 6287, 5000, 5000, 11000, 5000, 12452, 26179, 6500, 6000, 5591, 6745, 9864, 5000, 8500, 9078, 5000, 12000, 6035, 5000, 6500, 5000, 6500, 5000, 5000, 10500, 5000, 9500, 19230, 17000, 5000, 5000, 14000, 20370, 6070, 5000, 5000, 19753, 17691, 5683, 5000, 5000, 5000, 6000, 10000, 7000, 8182, 5500, 7380, 7196, 15000, 7000, 11406, 5917, 6000, 15539, 15500, 5500, 5000, 6000, 6000, 12500, 7000, 5418, 9000, 16929, 15435, 5000, 7616, 8500, 6000, 5500, 5000, 5000, 5886, 17505, 5000, 6825, 5955, 5000, 5000, 5374, 6857, 6122, 8500, 12500, 7394, 5000, 5767, 6500, 5000, 15104, 21354, 5000, 5500, 5000, 5770, 11000, 11540, 5000, 7156, 18000, 20000, 10000, 7085, 5000, 5354, 5000, 5000, 6000, 20270, 7000, 6000, 5493, 5000, 5500, 16000, 5000, 5000, 6000, 5000, 7007, 8036, 5000, 8474, 5000, 5858, 5000, 12000, 5000, 5000, 10500, 9500, 5968, 11500, 5500, 7000, 7500, 6107, 5000, 10500, 10000, 19500, 13000, 22000, 5000, 7500, 5000, 5000, 11980, 6000, 9500, 5000, 6373, 5327, 10738, 5000, 8277, 9000, 37000, 11000, 8500, 5000, 28747, 6000, 22500, 6000, 5000, 6500, 5000, 5000, 9500, 5000, 5836, 13000, 6122, 16000, 5000, 8500, 5000, 5000, 6000, 7987, 20505, 5000, 8034, 12000, 6000, 5000, 8500, 5634, 9500, 5701, 5500, 5500, 9665, 6000, 11000, 5000, 13000, 7000, 5371, 5500, 7000, 5000, 5065, 6479, 16297, 7000, 5000, 17000, 7567, 5628, 5000, 9000, 6045, 22142, 5000, 5000, 11000, 10000, 5818, 5000, 5000, 7000, 10000, 10000, 5000, 9500, 5000, 8088, 5000, 22000, 14311, 8000, 11500, 6873, 5000, 11500, 5000, 7500, 6044, 10500, 5000, 5500, 7457, 5000, 15611, 5500, 18448, 5000, 6096, 5000, 5500, 14500, 5000, 6997, 5000, 5000, 5000, 5000, 6441, 6185, 5500, 10500, 8500, 9500, 8000, 8000, 8500, 6544, 5500, 5000, 5000, 5500, 5689, 5683, 5000, 6000, 15000, 7628, 12802, 8106, 6763, 5000, 13500, 13500, 6948, 5736, 5482, 5000, 5500, 6000, 17500, 7500, 5000, 5000, 5000, 6500, 9918, 17701, 7500, 5000, 7500, 12707, 8500, 6000, 6295, 5587, 7000, 5000, 7263, 5000, 8241, 5323, 10000, 5000, 5500, 5500, 10394, 7734, 5000, 5000, 5000, 6067, 5000, 5000, 5000, 5000, 9705, 5000, 14000, 6138, 5415, 5000, 16000, 8704, 6000, 5000, 13458, 6599, 5000, 26398, 5000, 5786, 5000, 9671, 6000, 6000, 21000, 66000, 7000, 14000, 5000, 6297, 9000, 5000, 6126, 9000, 12000, 6577, 5716, 13493, 5757, 5413, 5000, 5000, 10500, 5000, 9000, 5000, 6500, 8500, 6500, 11000, 5500, 5500, 5000, 9500, 5000, 8500, 6201, 5000, 5000, 5407, 5377, 9000, 7644, 6655, 5500, 5500, 5000, 10000, 5000, 5000, 14500, 11000, 6500, 28500, 5000, 7500, 5856, 16000, 5324, 5413, 12000, 9500, 8000, 10000, 6405, 5000, 7000, 5000, 5000, 6377, 5500, 6956, 6876, 5000, 5000, 5000, 6082, 21000, 5000, 14000, 6000, 5000, 5000, 10500, 6000, 5000, 5500, 6500, 26000, 8500, 8844, 12452, 7500, 5000, 6332, 44000, 6000, 5000, 5626, 7000, 9500, 5000, 16000, 5500, 7500, 5500, 6500, 7785, 5913, 5000, 8500, 7204, 10500, 11000, 14000, 7000, 5000, 5000, 16587, 5500, 5709, 7722, 10000, 9500, 13000, 5000, 8324, 5000, 5000, 6500, 5000, 10500, 5614, 6500, 11000, 6713, 5500, 5000, 7000, 5000, 5000, 9101, 6478, 10000, 7223, 5000, 5000, 7500, 5694, 6000, 5000, 5000, 8000, 11000, 5000, 9000, 7500, 5000, 6000, 14000, 5636, 8000, 7087, 9356, 8500, 5000, 6500, 5000, 5000, 5000, 5000, 5000, 8007, 6000, 10500, 5000, 5000, 7927, 7000, 5000, 5187, 13000, 5000, 10500, 7613, 7315, 5000, 5000, 5000, 6500, 5000, 5000, 5000, 5000, 5190, 15753, 9500, 13000, 6437, 5000, 7500, 5000, 7000, 7500, 8698, 8500, 12000, 5000, 5000, 18316, 5552, 20145, 5000, 5000, 8500, 9843, 7000, 5000, 6204, 6000, 17000, 11000, 5500, 16175, 5000, 10000, 5000, 5000, 8371, 7000, 5733, 7500, 8000, 7500, 5000, 5000, 8391, 5000, 20884, 5000, 9087, 5000, 5000, 6053, 7161, 7500, 5500, 9500, 5951, 13115, 5687, 6500, 8897, 5000, 7000, 7125, 8000, 6549, 8734, 30000, 5000, 16018, 7347, 5000, 5000, 13884, 8000, 5000, 5000, 5000, 5000, 29632, 7500, 5000, 10000, 5000, 5000, 10000, 5000, 5000, 5000, 5000, 5500, 8367, 7500, 6999, 5000, 5000, 12000, 5500, 7000, 27500, 6000, 5500, 8000, 5000, 5999, 4500, 5000, 8500, 9806, 5000, 6000, 5000, 10500, 5000, 16000, 5000, 5000, 5775, 5000, 5000, 5000, 5733, 5000, 14907, 5000, 5000, 6595, 5000, 5000, 7335, 11500, 6000, 6000, 7526, 5000, 5000, 7767, 7193, 5570, 5000, 6005, 5000, 5454, 6287, 7447, 6181, 12000, 5000, 7000, 7000, 6000, 16324, 8080, 6500, 8000, 5000, 7500, 5000, 5000, 10500, 5000, 7500, 16732, 5000, 7227, 5464, 7500, 7500, 5000, 15000, 9219, 5000, 5000, 5000, 5000, 5000, 5000, 7117, 14000, 5768, 6473, 5000, 5000, 5000, 7000, 5000, 5000, 5351, 7000, 18121, 5000, 6500, 5000, 9593, 5000, 8000, 6000, 5500, 5000, 5570, 5500, 5000, 6408, 5000, 18178, 7187, 5000, 5000, 7500, 5000, 5000, 5000, 9500, 5000, 7950, 5000, 7500, 9500, 5517, 21500, 6778, 27157, 8500, 30000, 12500, 5000, 10500, 5000, 5000, 5597, 7000, 8000, 6657, 8604, 5000, 6000, 6956, 5000, 5000, 33000, 5000, 6178, 12000, 5000, 5000, 5000, 5000, 18157, 5651, 9956, 5000, 13000, 5000, 21500, 8000, 10716, 5000, 7062, 5000, 7294, 8726, 7000, 6188, 5642, 10000, 8056, 5173, 7000, 5000, 5840, 17000, 8942, 6000, 6500, 8500, 16818, 16112, 15000, 6388, 8000, 6500, 5000, 9106, 9500, 5000, 5000, 6905, 5000, 10500, 8910, 5000, 5000, 5000, 6500, 7000, 13500, 5427, 5000, 6499, 5000, 6535, 5000, 8000, 7500, 5331, 7996, 5000, 5000, 5707, 7000, 13500, 11540, 5000, 5000, 5000, 8500, 15130, 5000, 6000, 9000, 5000, 8691, 9500, 5000, 5000, 7065, 5000, 5000, 8500, 6348, 6000, 5000, 19500, 5000, 5000, 6500, 12000, 5000, 5000, 5000, 5500, 5000, 5000, 9000, 12500, 5000, 5000, 5000, 7500, 6500, 6687, 5500, 5229, 5000, 5545, 6091, 6024, 16500, 7500, 10000, 11818, 15665, 9000, 5000, 8000, 6437, 5000, 20551, 9500, 5377, 12000, 5000, 6000, 6000, 18268, 6500, 5000, 5500, 10949, 5946, 5000, 5000, 5000, 5000, 5000, 5773, 5000, 6500, 7108, 5000, 8000, 5000, 5000, 5000, 10500, 5245, 5000, 5000, 5000, 5000, 10500, 5500, 5000, 7500, 5000, 5000, 5323, 7000, 9219, 8500, 6579, 10000, 9000, 5000, 7500, 11000, 5351, 5000, 6000, 13500, 6985, 17000, 7000, 5000, 10500, 10987, 5000, 5000, 6265, 5000, 7500, 5000, 7706, 10500, 5000, 5000, 5577, 5000, 13500, 10000, 5418, 5000, 5000, 22746, 6500, 5000, 5000, 5000, 5000, 17054, 5000, 24159, 7224, 5724, 20890, 13000, 6617, 5000, 22000, 5970, 5000, 6465, 5000, 6500, 7727, 5000, 9500, 7912, 5000, 15000, 7500, 8000, 5000, 5205, 5000, 5000, 6955, 5000, 5000, 8000, 6000, 5257, 8484, 5785, 6500, 5057, 10978, 5921, 9989, 30000, 6000, 5214, 5593, 5213, 10000, 5000, 8000, 7500, 8080, 17178, 10000, 6000, 21240, 5666, 5000, 17000, 6000, 9056, 5000, 7127, 6500, 5000, 6500, 11000, 10000, 5000, 6460, 5500, 8000, 6265, 5000, 5000, 22327, 5000, 6500, 11727, 5648, 5000, 5714, 8085, 5000, 8500, 10000, 5000, 15500, 5500, 5000, 5000, 6500, 14949, 7500, 7500, 10237, 5000, 8500, 5654, 6500, 11000, 13000, 5197, 5000, 5000, 5000, 5500, 12500, 6134, 15032, 8500, 10000, 5000, 5000, 7137, 7500, 6000, 7769, 7242, 5375, 5000, 20756, 11000, 8000, 5920, 5500, 5000, 9005, 5000, 6500, 5000, 6110, 5000, 5000, 16491, 5000, 5000, 6500, 5000, 6267, 16337, 5000, 5863, 5000, 5676, 5000, 6500, 5436, 5000, 6000, 7486, 5000, 5000, 6500, 8109, 5232, 7500, 6500, 5994, 7000, 6348, 5000, 5369, 5000, 12000, 6000, 5000, 5000, 7000, 8000, 6000, 5500, 5000, 5898, 6187, 5000, 7461, 13500, 5000, 5000, 5738, 5145, 25500, 16000, 5000, 5847, 5873, 5000, 9000, 10500, 21484, 5000, 5000, 7000, 11000, 7500, 5996, 5000, 5733, 6133, 6085, 6505, 16309, 10500, 6045, 14003, 5000, 5000, 6162, 11000, 15500, 20500, 7500, 14000, 12145, 5000, 5000, 5821, 5500, 5000, 5000, 15945, 12500, 5448, 5000, 5000, 15501, 5500, 11500, 5000, 7500, 5000, 5000, 5000, 6500, 6126, 6000, 5000, 9857, 5000, 5500, 9227, 5000, 5000, 5000, 12500, 9000, 9000, 5000, 16500, 7924, 5000, 8102, 5951, 5000, 10000, 15500, 11185, 8056, 17507, 27390, 5000, 7334, 5000, 5000, 5000, 5000, 8500, 30000, 5000, 16259, 5000, 11500, 5000, 17665, 5000, 5000, 11500, 5805, 7500, 6000, 8500, 6500, 5000, 5000, 6047, 6000, 7500, 26334, 5000, 5000, 7000, 5000, 17444, 7000, 13000, 6717, 10000, 5500, 5000, 17554, 5000, 5000, 6500, 6500, 7500, 5000, 5657, 7917, 5306, 5841, 10500, 17000, 11000, 8000, 23208, 6500, 5000, 5000, 5994, 5917, 6000, 9000, 5500, 5000, 5000, 5000, 5000, 10000, 5000, 5000, 10500, 5500, 10500, 7821, 6500, 6500, 5000, 9500, 9000, 6500, 6399, 5000, 5728, 18135, 5000, 13155, 5275, 11500, 6500, 7500, 5000, 15032, 5000, 7000, 6000, 7000, 11500, 6500, 5000, 5687, 7000, 6217, 5000, 5000, 5000, 9000, 13428, 10000, 5000, 8500, 5000, 5000, 8500, 6500, 5000, 5000, 17786, 5000, 28103, 5500, 5000, 14000, 15000, 5000, 5592, 7500, 5402, 7985, 16278, 5000, 6554, 5000, 16000, 5500, 7500, 13000, 18500, 8500, 5000, 12000, 5457, 6500, 9891, 7237, 6000, 5000, 5977, 5000, 21362, 11500, 7500, 7500, 9000, 6000, 5000, 15500, 7245, 9838, 7500, 5000, 5000, 10000, 7000, 5500, 7671, 5000, 5000, 7000, 7000, 5000, 10000, 5000, 9000, 5890, 7121, 22291, 6997, 8680, 10000, 5000, 7374, 8500, 6107, 7000, 5000, 10000, 10000, 6999, 4000, 5254, 5500, 5000, 5000, 13000, 6000, 5483, 9000, 8000, 8000, 18500, 8000, 5553, 5232, 5000, 5500, 5000, 20000, 6000, 5000, 5000, 6000, 5000, 5500, 6485, 7948, 5545, 5000, 5000, 6297, 5000, 4500, 6577, 5000, 5937, 5506, 5000, 5509, 6000, 7000, 6046, 5000, 5000, 7589, 5000, 6286, 5000, 5000, 6000, 7000, 13500, 5000, 6000, 9500, 5000, 5000, 5000, 5500, 5000, 5443, 7206, 5000, 14000, 5708, 6500, 5000, 7500, 5000, 20270, 8506, 7321, 8293, 18065, 5000, 5000, 6500, 5000, 6500, 5000, 29578, 6500, 5000, 21500, 7522, 6066, 9000, 15000, 6733, 5732, 5000, 5000, 5000, 5000, 14000, 5000, 5000, 5000, 10000, 6500, 5000, 5000, 6000, 10000, 5000, 5317, 7416, 16366, 16500, 7397, 18085, 5000, 7500, 5372, 5693, 5066, 5409, 6058, 5000, 5000, 6235, 8306, 5000, 10000, 5000, 5000, 10000, 5000, 5000, 6000, 23000, 5445, 15500, 5000, 5831, 30000, 47500, 5000, 5518, 6724, 9500, 5000, 7500, 5000, 5000, 11177, 7000, 7101, 5797, 10500, 10000, 13000, 7000, 23000, 6000, 5426, 15771, 5000, 7500, 29500, 7500, 5000, 8500, 5000, 5000, 12371, 5000, 7500, 5000, 7205, 6000, 30000, 5000, 16177, 5790, 5500, 7118, 5000, 5000, 5000, 15844, 5000, 7000, 8500, 17612, 9500, 15500, 16000, 13000, 5000, 15000, 6021, 8408, 7000, 5500, 6492, 5000, 10000, 8100, 5550, 9243, 6000, 14000, 5495, 11500, 8500, 7000, 6535, 7256, 10500, 5000, 6387, 5515, 5500, 5999, 5000, 15500, 9500, 6872, 5000, 5426, 7000, 5000, 5193, 5000, 7500, 15500, 10000, 7500, 15000, 10000, 6276, 6000, 5401, 5718, 5000, 11000, 5000, 11500, 8500, 5000, 6000, 5000, 5644, 11000, 15000, 5000, 8163, 8500, 6176, 5537, 8347, 6093, 5000, 5500, 7500, 5000, 8000, 5000, 30000, 6000, 6070, 5000, 22489, 5999, 5500, 6500, 5000, 5000, 9000, 20000, 5000, 29460, 5500, 5000, 13000, 7500, 7500, 7935, 5000, 23305, 10200, 5000, 5000, 5000, 5933, 5000, 5000, 5000, 5000, 5000, 15853, 14253, 7000, 10000, 5000, 5596, 5994, 7243, 6000, 9000, 5000, 5000, 6177, 7000, 5500, 8563, 5000, 8000, 16508, 5000, 5000, 5000, 7500, 7000, 5000, 5000, 8341, 6500, 5000, 5000, 5000, 5000, 6500, 5000, 11000, 5500, 5000, 17000, 5000, 15690, 5000, 5000, 5000, 5773, 7967, 9771, 5000, 5000, 5000, 6767, 13000, 5000, 5000, 7643, 9817, 5000, 6677, 14317, 5000, 5787, 6000, 10000, 7361, 5000, 8500, 7487, 7975, 8500, 12000, 15996, 5000, 25500, 5000, 7000, 5717, 5000, 5500, 5500, 11000, 5000, 6684, 13000, 5000, 8974, 5500, 5000, 5414, 10500, 7000, 6500, 10500, 9000, 5000, 5000, 5000, 5000, 5000, 7980, 5000, 7500, 7000, 6000, 5583, 13000, 10000, 7546, 5000, 10000, 5000, 5000, 5000, 7500, 25197, 6196, 7500, 21914, 6000, 5000, 5000, 6000, 7000, 5000, 5000, 5000, 5000, 6000, 5000, 5000, 7147, 6331, 5000, 5000, 5000, 22479, 5500, 5000, 7907, 5000, 10395, 5000, 5000, 5000, 22570, 9526, 5000, 5534, 12000, 5000, 5000, 6000, 5000, 6575, 7348, 8753, 7000, 5500, 5000, 5000, 6085, 6926, 5000, 10000, 13000, 5437, 7500, 9500, 10000, 10000, 15000, 7455, 16006, 5000, 5000, 8000, 5000, 10889, 5500, 5500, 7228, 5986, 7500, 5000, 6000, 7000, 5000, 21500, 5000, 5000, 6888, 5000, 6955, 11137, 5000, 16000, 5000, 6500, 10500, 8500, 10000, 13606, 5327, 6500, 5593, 5000, 17502, 5000, 8000, 12000, 6999, 5000, 5500, 15000, 14495, 10000, 7325, 10000, 23428, 12500, 23335, 5000, 5000, 7000, 13500, 5000, 5000, 10000, 5000, 5000, 5000, 19500, 5500, 5904, 6000, 5000, 5000, 5000, 5785, 5201, 5000, 14500, 8000, 6500, 8500, 5000, 5000, 6107, 5000, 10000, 12500, 35000, 5000, 5000, 5000, 5000, 13664, 10000, 7500, 10000, 5000, 5000, 5000, 7500, 5432, 5000, 7000, 5000, 5000, 5000, 5000, 9500, 5000, 5000, 9636, 5500, 16040, 5000, 5000, 7380, 5000, 5000, 6000, 5500, 5593, 6433, 5000, 7500, 5000, 10000, 16588, 5000, 10500, 8000, 7000, 5000, 5406, 7000, 5000, 9777, 11000, 5000, 5000, 11500, 10000, 5629, 7217, 7000, 5000, 8500, 13846, 5500, 10000, 6000, 10500, 5414, 22350, 7500, 9288, 5000, 10000, 10000, 6436, 5000, 5376, 5000, 7152, 5000, 5000, 7000, 8500, 5503, 5605, 5684, 16845, 17561, 5628, 9042, 14073, 5000, 8500, 27042, 16000, 5000, 5465, 5000, 5556, 10500, 6000, 7607, 5000, 5000, 6000, 7622, 10000, 8500, 16000, 10500, 6312, 9000, 5000, 5500, 29557, 5000, 5662, 5323, 8000, 6085, 14000, 5000, 8033, 5000, 5999, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 6427, 6500, 13500, 10296, 5000, 7688, 9500, 5000, 16500, 6500, 5000, 5424, 5000, 10000, 5000, 5798, 8268, 9570, 6000, 5000, 5000, 6500, 5000, 5000, 5000, 16794, 5000, 5000, 10000, 8500, 8500, 13292, 7357, 5000, 5000, 5000, 5500, 5500, 6200, 5000, 5000, 5853, 6000, 16785, 9937, 7500, 6000, 5000, 6500, 5000, 5563, 5000, 7000, 6190, 5965, 5500, 5511, 9000, 6000, 5000, 5000, 7000, 10500, 5513, 6192, 5000, 6500, 5000, 26636, 5500, 5000, 7500, 8488, 5000, 5755, 5644, 6000, 5000, 5000, 5000, 5000, 5000, 5586, 7000, 7148, 18500, 5000, 6500, 5000, 6500, 7000, 7000, 16521, 9000, 5727, 9877, 7000, 13500, 6500, 12000, 5000, 22500, 5000, 5000, 5000, 5500, 15500, 5000, 5000, 5000, 5000, 5000, 6000, 9000, 9000, 5000, 6861, 5488, 5565, 6000, 5000, 5700, 5000, 5500, 9120, 5000, 6098, 7547, 5000, 30000, 5000, 5972, 5000, 5000, 10045, 5076, 7684, 5000, 5000, 6500, 5000, 8615, 7500, 5500, 5000, 5000, 11500, 5363, 5000, 5992, 5000, 7500, 12934, 8000, 22000, 8000, 5000, 5000, 5000, 5000, 5565, 5213, 15920, 5000, 7302, 48500, 6500, 19500, 5000, 5000, 8424, 6500, 6074, 5000, 5000, 5000, 5500, 5000, 5000, 6796, 13000, 5000, 11118, 13036, 5000, 7500, 8000, 11000, 5000, 29962, 5000, 6000, 9500, 5000, 5286, 13000, 16610, 6500, 8500, 5724, 5464, 5000, 7037, 6000, 20627, 5000, 8000, 10000, 5000, 10500, 5000, 6500, 12000, 5000, 25651, 5000, 5500, 6847, 7000, 5000, 6000, 7655, 6737, 5437, 15500, 15679, 15000, 5000, 7912, 21500, 7000, 6987, 6257, 5500, 5766, 5000, 5000, 5000, 5000, 10000, 14661, 16403, 5000, 5727, 5000, 5500, 10500, 5000, 5442, 16500, 8000, 5000, 5000, 5000, 9000, 7500, 5642, 7985, 5000, 5000, 9000, 10000, 10000, 12452, 5000, 11000, 7500, 11851, 16500, 5000, 6277, 10000, 5817, 30000, 17038, 6064, 5000, 5000, 7999, 11500, 5000, 6500, 24500, 10500, 7500, 7272, 7500, 5000, 13232, 9500, 5000, 6000, 5000, 5000, 10000, 5000, 7500, 5000, 7723, 5688, 5000, 5000, 5627, 5442, 17511, 7000, 5405, 18747, 5000, 5500, 5956, 7500, 5000, 8500, 6000, 7941, 11000, 5000, 5000, 5000, 13000, 5000, 11000, 5500, 5000, 5000, 7245, 5000, 7000, 7338, 6217, 9000, 11500, 5686, 24590, 5757, 6088, 6000, 7854, 5000, 5000, 6000, 5000, 5000, 5000, 7000, 9000, 5000, 6500, 14000, 5735, 14005, 6000, 7000, 6244, 7205, 5500, 6500, 5000, 7500, 5000, 7000, 10063, 8000, 6125, 5586, 6404, 5000, 5000, 5000, 5000, 5197, 8063, 5425, 6442, 8202, 5000, 5000, 6065, 5796, 7177, 10500, 5000, 5000, 13500, 5500, 6916, 5387, 11500, 6143, 5000, 17500, 6497, 6500, 5000, 10500, 10500, 6933, 5000, 9500, 5000, 9000, 8000, 5000, 5000, 5000, 16174, 6000, 13000, 5770, 5000, 5000, 5000, 6500, 7500, 5000, 5976, 5000, 5998, 16328, 17500, 7000, 5000, 5500, 5000, 5312, 19922, 13000, 5000, 13000, 5000, 5000, 6000, 5000, 5000, 7471, 10000, 6500, 15586, 13500, 7500, 8000, 7500, 5646, 5000, 14683, 10000, 5000, 10500, 21949, 6467, 7421, 5000, 10000, 5000, 7500, 7500, 5000, 6500, 7145, 11000, 5846, 5000, 7500, 9723, 7112, 7500, 5289, 8000, 5500, 5962, 10000, 5000, 14153, 8000, 5000, 5000, 12942, 10500, 5000, 5000, 6662, 7000, 5000, 6000, 9380, 5000, 5704, 15176, 5000, 16995, 5000, 6000, 5000, 7076, 8000, 10000, 6000, 7500, 8500, 9500, 5563, 6000, 5000, 17355, 8500, 5000, 5744, 5000, 5000, 32500, 5000, 5000, 11500, 5000, 5000, 5000, 5000, 6176, 5764, 5500, 13000, 5500, 7000, 10500, 5000, 10500, 6500, 7071, 10500, 6500, 17633, 13000, 10000, 6421, 7500, 5000, 8000, 5000, 22488, 19638, 9500, 5000, 5000, 5000, 5000, 14661, 11000, 5457, 5000, 7607, 5000, 6000, 7500, 5000, 5882, 5000, 5000, 6464, 6370, 6500, 5000, 8500, 7500, 5000, 23190, 19500, 5000, 5000, 7500, 5000, 5000, 6220, 6002, 11000, 5500, 5000, 6499, 5000, 5000, 5500, 6066, 7642, 6821, 5000, 8500, 6166, 5845, 5000, 5000, 7500, 6326, 6000, 5000, 5000, 9500, 5000, 5000, 6000, 12500, 5000, 22982, 5807, 5000, 16375, 15814, 5000, 6000, 10500, 6035, 5000, 26825, 5000, 5500, 5000, 5000, 5000, 7500, 11500, 5500, 5884, 5500, 6500, 5000, 6442, 5000, 5000, 6237, 8657, 7897, 6726, 5000, 7335, 10500, 5000, 8128, 7500, 5000, 6664, 8000, 5678, 7000, 12500, 20532, 5393, 6000, 6500, 7369, 12500, 5000, 18003, 30000, 5000, 21000, 5622, 5000, 5517, 5000, 6257, 5000, 10000, 5000, 5198, 7369, 5000, 14500, 16570, 6445, 15000, 7300, 16500, 7500, 56000, 5732, 5000, 5500, 5000, 5500, 8676, 5000, 8000, 5737, 5000, 10000, 30000, 6497, 5000, 7500, 5000, 5970, 7000, 5629, 7000, 5227, 5727, 5000, 5000, 5500, 8559, 9000, 6000, 7376, 5000, 7000, 16129, 5000, 10000, 10500, 9012, 6000, 5000, 5000, 15000, 9121, 6892, 7241, 5311, 7500, 5000, 5000, 12500, 5000, 5973, 5500, 17812, 18411, 5000, 7728, 5000, 8077, 5000, 7000, 6382, 9000, 8500, 6500, 5000, 5000, 5000, 5500, 5000, 11000, 9587, 5000, 5147, 8500, 5000, 6000, 59000, 10000, 9500, 5000, 5981, 4999, 5276, 6000, 5000, 6035, 5993, 5000, 16016, 5500, 5000, 5000, 7500, 5000, 13000, 8000, 5000, 7500, 5000, 9000, 23076, 5500, 5999, 5000, 9500, 5000, 7500, 15851, 5000, 5000, 8000, 7049, 5813, 6122, 10000, 22765, 10500, 5500, 5000, 5000, 12000, 5000, 8000, 9102, 15000, 5000, 5373, 6000, 13000, 72000, 6500, 28896, 5000, 5000, 6500, 5000, 5000, 13768, 5000, 6346, 5000, 6012, 5000, 5500, 10500, 5000, 15000, 6404, 5000, 5000, 5000, 5500, 5500, 22141, 6500, 5000, 9500, 10000, 10000, 9217, 9500, 5647, 7000, 7500, 5000, 20000, 30500, 5000, 5000, 5765, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 16500, 5000, 7500, 5000, 6192, 7500, 5000, 7000, 5447, 5000, 5000, 5000, 9500, 12500, 5000, 5000, 5000, 5000, 5500, 5500, 10500, 6422, 9500, 7500, 5000, 5000, 7500, 10500, 5000, 7500, 7000, 8000, 12000, 26111, 13008, 21500, 5000, 11990, 7553, 5201, 5000, 5807, 5000, 5000, 5000, 5000, 4500, 6500, 7000, 6947, 7500, 5000, 6500, 5000, 5000, 5500, 5000, 5595, 6500, 7500, 5500, 5965, 19000, 12000, 21500, 6000, 16015, 7000, 8000, 6000, 10500, 6500, 5000, 7000, 5000, 10000, 5000, 5457, 5000, 7500, 22500, 5213, 5000, 5000, 17500, 5000, 5000, 7500, 7722, 18000, 17000, 5404, 5000, 5000, 10000, 10000, 11000, 6288, 11000, 5000, 5000, 5000, 5000, 19490, 6500, 5000, 5797, 5000, 5000, 6073, 14186, 5000, 6500, 7772, 11794, 23449, 5000, 7000, 5000, 5000, 5000, 5000, 5000, 5000, 30000, 7616, 6085, 13804, 5000, 5000, 13500, 5500, 19831, 5000, 5000, 21718, 5000, 5000, 5180, 11052, 14000, 14737, 5000, 5666, 5000, 5000, 5487, 5226, 5000, 5000, 5000, 7500, 6000, 5717, 5633, 22942, 5000, 5000, 8777, 26740, 5000, 5500, 7000, 10500, 5000, 5000, 5000, 5000, 7500, 11788, 18000, 16000, 5000, 11000, 5000, 5000, 7820, 6944, 5000, 7000, 6500, 5000, 8000, 16335, 5000, 5430, 7277, 6500, 5500, 5000, 5000, 9644, 8297, 7000, 20756, 6500, 5096, 16560, 8000, 5911, 5000, 6000, 13500, 5000, 5000, 5000, 16500, 5117, 7103, 5644, 5000, 5000, 5000, 7000, 6604, 5000, 5000, 5000, 7500, 5000, 10500, 20993, 5277, 5733, 5000, 9500, 11500, 5000, 7887, 12000, 5445, 9906, 8436, 10767, 5000, 5000, 9500, 6173, 10000, 14997, 5000, 5500, 5000, 7128, 5500, 5000, 5000, 5964, 5500, 6702, 8000, 8000, 5500, 8156, 5000, 5775, 5000, 5000, 6500, 5575, 6017, 6500, 6500, 6393, 5000, 5000, 21485, 21656, 5000, 6358, 5500, 8000, 5000, 15849, 5000, 5500, 5000, 6815, 5000, 6500, 5583, 10884, 5000, 8377, 5000, 10000, 5000, 5000, 5000, 5000, 5500, 9000, 9705, 5000, 10000, 5000, 5000, 24500, 13846, 5251, 8389, 5000, 5000, 5865, 13500, 5000, 15624, 5000, 7000, 15500, 5000, 6731, 5000, 5000, 8500, 5000, 24000, 9000, 5000, 8985, 15657, 7500, 12500, 5000, 5000, 7150, 5000, 5500, 5000, 28996, 5543, 7497, 6268, 6049, 5000, 5000, 5966, 12500, 17500, 7500, 14109, 5000, 5000, 7500, 5000, 14000, 5000, 7500, 6089, 5000, 16000, 5000, 5727, 16000, 5000, 7022, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 8107, 5545, 7500, 19500, 20164, 5500, 19500, 5417, 9500, 5545, 5000, 5000, 6500, 5000, 28161, 11000, 6500, 5000, 5000, 5000, 6217, 5000, 6926, 7396, 7000, 10500, 5000, 5000, 5000, 5000, 5000, 10500, 5000, 5000, 15000, 5000, 5000, 6038, 5000, 7327, 5000, 9500, 8267, 5445, 6265, 5000, 5000, 5487, 11500, 5000, 6488, 8000, 5000, 14000, 5000, 6000, 5000, 5000, 7000, 6500, 6105, 6717, 5000, 6527, 5000, 5000, 5000, 5258, 5000, 12500, 9000, 5000, 10000, 20000, 6057, 5000, 5000, 13500, 7000, 15500, 5667, 6927, 6000, 5000, 6000, 5000, 5000, 6625, 5488, 5000, 5000, 5000, 5000, 8496, 9861, 5937, 5500, 8500, 5000, 5000, 5000, 13931, 5000, 5000, 5500, 5757, 37000, 5000, 28274, 6500, 5000, 9500, 5613, 9500, 7000, 10288, 6492, 5000, 9500, 10000, 5000, 20500, 15500, 6421, 21500, 5735, 21996, 8080, 5861, 5000, 6000, 7662, 7500, 5000, 5000, 15134, 11500, 18500, 7500, 29500, 5500, 5000, 7000, 5500, 15995, 8376, 5000, 6572, 8000, 11500, 5000, 8000, 21994, 5000, 6505, 6527, 5000, 5500, 5000, 7841, 9718, 5000, 21430, 5000, 14000, 7466, 5000, 5000, 5500, 5000, 14335, 16000, 5000, 5000, 5500, 5000, 5000, 5000, 6499, 5000, 7175, 20000, 7500, 5000, 5000, 6500, 5000, 5000, 6000, 11500, 8500, 5000, 30000, 22134, 5000, 5000, 7000, 6500, 5000, 5000, 5000, 10461, 12500, 6625, 5000, 5000, 9000, 7500, 6500, 6107, 20593, 7435, 10000, 5325, 13000, 13862, 8707, 7500, 8000, 12500, 5000, 7007, 9500, 9500, 6337, 13747, 5000, 5000, 5409, 7500, 5000, 7686, 5000, 6000, 5321, 5000, 24114, 9000, 10000, 8500, 24256, 69000, 12000, 6091, 30000, 5000, 9500, 5000, 17000, 11000, 5000, 5000, 15500, 5000, 6193, 8507, 15274, 9506, 5000, 10500, 5000, 5000, 6500, 5000, 5000, 7500, 5673, 5648, 11500, 11500, 7000, 5000, 5000, 6373, 17531, 5000, 5422, 19500, 10500, 5000, 5271, 5000, 7500, 5000, 5000, 5500, 11500, 6000, 10000, 18954, 7500, 5000, 5000, 5000, 7026, 49000, 5000, 10500, 10564, 5000, 5000, 12000, 19000, 5687, 12087, 5000, 15671, 5000, 5853, 7500, 12575, 5000, 5500, 13397, 9234, 8000, 14500, 6500, 5000, 6500, 5653, 17518, 5545, 5000, 6500, 5000, 5337, 7000, 5000, 15505, 6106, 7000, 5000, 5000, 5000, 5000, 5000, 7166, 17880, 7913, 5758, 6616, 17500, 6500, 5000, 5000, 5000, 5000, 5000, 5000, 6000, 7333, 5000, 5000, 5000, 5000, 5000, 15000, 6000, 6772, 5217, 7841, 5000, 6766, 7500, 12500, 10500, 5000, 7000, 5000, 6692, 19230, 5219, 14000, 7027, 5500, 5000, 14321, 6000, 5000, 7500, 5000, 5000, 5000, 8500, 6500, 9205, 6500, 5602, 15000, 5726, 11000, 5000, 15946, 6000, 9535, 12500, 8500, 15500, 5484, 7500, 5000, 5000, 30000, 5000, 7711, 16620, 6000, 9000, 5000, 5461, 5000, 7500, 5000, 5000, 5000, 8911, 5000, 15500, 18161, 5500, 10000, 5000, 7438, 8177, 5000, 19553, 5500, 6500, 5842, 5000, 16828, 7500, 5000, 8500, 12378, 19235, 6726, 14092, 6000, 5000, 9500, 5000, 5824, 8500, 5000, 17500, 5500, 5000, 5000, 21169, 5000, 5000, 6000, 5000, 5435, 5500, 6087, 16843, 5000, 5000, 6000, 5000, 5587, 9000, 5000, 7500, 5000, 5000, 9768, 10000, 5718, 5667, 7500, 5000, 5000, 10777, 5000, 5117, 5574, 7187, 5000, 5000, 5000, 10976, 5000, 5000, 8000, 5000, 5000, 5252, 20890, 5000, 16500, 5000, 5000, 20627, 5214, 9500, 9000, 5000, 5956, 6263, 5000, 6022, 12315, 5541, 5361, 6000, 13500, 5500, 5000, 5921, 5000, 6999, 5578, 5000, 5000, 5000, 9505, 20347, 5000, 5500, 19415, 8000, 5000, 5000, 7500, 8680, 5000, 7441, 6500, 6500, 5106, 5477, 5000, 8398, 11500, 10000, 5500, 5000, 11500, 5000, 12500, 6500, 10000, 5000, 5000, 30000, 5000, 5000, 7965, 16482, 5000, 5000, 5000, 8000, 5000, 5000, 8500, 7216, 6000, 5000, 5788, 5000, 5000, 5000, 5000, 6000, 5000, 5000, 8136, 5000, 30000, 5000, 6191, 12500, 5000, 13088, 5000, 5000, 11500, 10500, 18000, 11431, 6500, 6500, 5000, 5500, 5000, 5000, 6000, 15712, 5000, 6008, 9671, 5000, 7856, 5999, 13000, 5000, 5000, 6000, 7500, 5346, 5000, 5000, 6668, 5816, 5000, 8500, 7643, 8315, 9500, 5000, 9500, 7500, 16500, 20117, 10787, 5500, 5816, 5000, 19429, 10000, 5000, 6000, 5500, 6462, 10000, 6000, 20856, 6000, 5000, 5000, 5000, 11500, 18500, 23000, 7500, 5000, 5000, 5000, 33000, 13428, 6264, 5565, 6000, 5500, 10000, 5000, 5000, 7211, 8753, 7500, 11000, 18500, 5000, 5000, 5000, 6128, 14081, 5000, 6173, 5000, 5000, 5788, 8000, 5000, 10000, 5867, 7000, 5000, 15793, 7500, 5000, 6053, 10000, 5000, 5000, 6500, 5258, 17000, 5000, 5000, 6000, 5000, 5000, 7000, 5488, 7929, 5000, 5500, 10000, 5000, 5000, 5000, 5374, 5000, 5000, 5000, 5000, 6000, 9500, 5000, 10980, 6000, 16587, 18000, 5500, 5988, 5000, 6500, 5000, 5000, 9498, 5000, 5000, 5000, 7179, 15660, 5000, 8000, 5500, 5500, 5000, 16500, 15500, 8000, 5000, 8097, 3000, 5000, 11500, 8175, 5665, 5000, 11500, 5000, 21158, 10500, 5000, 7500, 6500, 8000, 5000, 15500, 5000, 13000, 5000, 6000, 7500, 7355, 5000, 6000, 6677, 5697, 5000, 5000, 6157, 7000, 6000, 5000, 12923, 5972, 10500, 5000, 6114, 6016, 5000, 6212, 9861, 5000, 7500, 13500, 5500, 5500, 5000, 5000, 15830, 5000, 6000, 11000, 9000, 5177, 23500, 5777, 5716, 5000, 5000, 5452, 5000, 7464, 5000, 6438, 5000, 12500, 14000, 8103, 8314, 5000, 22000, 5000, 7358, 5000, 13500, 7500, 8806, 7500, 16500, 20790, 27001, 5927, 5000, 5472, 6500, 9000, 17057, 5390, 7531, 8500, 5000, 21500, 5500, 8000, 8695, 12500, 14577, 5000, 7299, 5000, 9561, 5000, 7899, 6528, 9380, 8500, 9500, 5000, 5000, 9000, 7500, 5500, 8000, 5964, 5000, 9500, 7012, 7204, 5222, 6000, 5000, 5000, 7000, 7287, 5000, 6447, 5587, 5000, 6500, 5000, 5628, 5000, 5612, 5337, 5000, 30000, 5000, 5835, 5000, 5000, 10500, 10000, 16500, 5000, 5000, 10000, 5000, 10694, 5000, 18500, 12500, 7000, 6500, 5500, 5500, 5000, 5000, 5000, 5000, 5000, 6500, 5000, 5498, 24500, 5999, 17000, 5000, 7000, 5000, 5500, 9996, 6500, 6000, 5000, 5000, 5000, 5711, 5000, 9265, 5994, 14301, 5000, 6000, 6095, 5000, 5000, 6000, 27078, 7500, 5000, 9500, 13699, 9000, 5000, 18261, 5693, 7752, 10500, 5766, 10563, 20000, 5000, 6244, 14500, 12500, 7500, 5000, 5500, 9500, 8500, 5517, 24000, 5000, 6304, 5000, 7500, 5000, 6221, 5000, 5000, 5000, 14910, 11000, 8000, 11500, 16500, 7500, 5000, 5626, 6777, 6247, 5000, 6713, 7000, 5000, 14500, 10500, 6245, 5000, 10000, 5754, 14000, 13500, 5000, 5500, 10000, 5000, 4999, 6472, 5000, 5000, 8326, 5000, 6505, 8500, 7500, 6000, 5000, 5000, 11000, 6000, 5000, 6500, 6500, 9500, 5565, 18743, 8500, 6000, 8285, 7500, 5000, 11000, 31000, 14540, 5000, 5000, 11500, 7297, 5000, 5000, 5188, 5000, 5000, 5000, 5000, 11000, 9000, 6013, 5000, 5000, 5000, 5000, 5000, 5500, 5500, 5000, 5000, 11500, 10000, 7086, 5000, 5000, 5000, 16000, 7000, 5686, 8000, 5000, 5000, 5000, 5876, 10000, 5000, 9500, 5000, 5000, 11614, 5500, 6500, 5492, 5000, 14398, 11500, 19116, 5000, 5000, 5837, 5000, 5000, 5500, 7000, 5000, 5544, 5000, 5000, 10000, 6500, 6512, 5000, 5532, 37000, 7439, 5000, 5000, 5000, 5000, 8500, 7757, 5500, 7837, 9000, 10000, 5000, 5000, 6000, 7728, 13500, 5000, 5000, 5000, 15573, 5000, 16500, 5000, 30000, 5000, 5000, 5000, 9000, 6423, 5000, 6000, 10000, 6500, 10310, 9764, 13226, 7000, 5000, 10500, 5000, 10000, 16324, 6304, 16000, 5000, 5901, 5000, 5500, 8500, 5000, 5000, 5000, 6500, 13624, 6000, 11000, 6000, 6135, 9543, 6233, 7848, 5000, 16500, 10500, 5000, 12000, 7500, 5927, 5000, 5000, 5752, 5000, 9582, 16500, 5000, 5000, 10000, 7124, 8000, 7685, 6499, 5725, 7500, 5000, 5000, 8500, 30000, 5000, 7398, 5857, 5000, 10000, 6000, 7500, 7500, 5000, 6073, 5000, 5000, 8000, 5000, 6000, 10000, 5000, 5000, 5000, 5000, 7510, 6000, 7500, 12000, 10500, 5000, 6000, 20500, 23000, 10000, 5000, 5000, 5567, 7000, 5000, 6000, 9000, 10000, 5000, 6000, 5500, 16090, 7500, 5498, 10500, 9500, 5000, 17573, 6226, 5500, 14500, 8000, 7088, 7126, 6000, 5000, 10000, 9000, 5000, 5000, 17000, 5000, 8305, 7000, 5000, 5000, 10000, 5000, 5000, 10000, 8500, 6000, 5000, 5000, 9000, 8128, 7666, 11000, 5000, 8000, 5500, 6500, 8527, 10500, 5000, 6000, 5325, 16067, 5000, 5000, 16004, 7500, 5000, 5000, 6000, 5000, 14237, 5000, 5000, 5500, 5000, 6138, 5831, 5000, 6000, 6929, 5000, 5000, 8167, 5000, 7615, 5500, 11898, 7500, 17099, 8000, 5000, 10000, 12000, 6077, 8506, 5000, 42500, 6966, 5000, 5000, 6486, 7000, 5000, 5000, 5000, 5000, 15875, 16070, 5500, 34000, 7500, 6000, 7500, 6653, 10000, 6499, 5000, 11788, 9637, 5997, 6462, 6877, 8500, 7000, 5000, 5000, 18131, 7500, 5000, 8000, 7736, 21570, 6605, 30000, 5000, 6000, 5762, 5000, 5000, 6311, 8500, 5000, 5000, 24000, 5073, 8000, 22245, 17762, 14296, 6500, 5000, 13000, 11500, 5000, 6500, 11000, 5000, 6593, 5000, 5000, 5996, 5000, 5000, 5000, 6257, 5000, 6500, 5000, 6500, 14000, 8558, 5000, 5000, 8500, 5000, 5999, 5000, 5000, 5000, 20000, 10500, 5000, 15846, 5000, 7500, 16500, 5000, 6500, 5982, 5500, 15421, 5484, 5000, 5892, 5217, 7156, 8889, 5500, 10500, 5000, 6617, 5000, 7500, 7000, 7000, 5500, 5000, 5000, 17878, 5000, 5000, 7396, 10000, 25920, 10500, 15500, 5696, 12500, 5000, 13500, 8753, 7000, 5813, 5000, 6500, 5500, 10000, 7500, 9500, 5000, 5000, 11000, 5000, 6000, 5000, 5000, 5000, 5000, 5000, 6807, 8085, 5000, 6500, 5500, 10500, 5615, 5500, 11500, 9356, 6500, 5000, 5000, 6000, 26148, 6000, 10500, 5000, 5000, 8258, 10500, 5000, 6000, 17000, 8500, 5624, 9811, 5000, 10000, 12500, 8500, 12500, 5000, 9500, 6500, 5000, 23325, 5000, 5196, 5698, 5000, 11183, 10000, 10500, 20640, 5000, 10500, 6170, 10000, 10000, 10000, 7000, 5963, 10000, 5500, 5500, 8246, 5573, 5000, 7000, 5689, 5000, 6500, 6000, 9500, 5000, 9000, 7500, 7000, 7457, 7302, 5000, 6500, 5000, 15500, 7000, 5500, 6807, 5000, 5377, 5000, 17328, 30000, 8219, 7576, 5000, 5000, 10000, 5986, 5000, 5000, 5500, 5000, 5000, 8285, 8500, 9500, 5000, 5000, 14237, 20153, 5500, 5000, 5393, 5445, 5000, 8410, 13000, 5387, 17000, 5593, 5500, 5000, 13963, 5615, 5000, 5000, 5283, 5000, 5207, 7000, 5000, 10000, 7281, 9500, 8000, 5000, 7000, 20540, 8500, 15500, 7500, 5000, 18120, 5000, 5000, 7000, 5000, 5211, 9000, 6000, 5000, 12923, 5000, 5000, 8000, 6500, 7500, 18500, 30000, 5000, 7000, 10000, 11500, 5000, 5000, 5000, 25927, 10500, 11500, 5000, 7000, 7671, 10500, 6865, 5000, 8000, 5000, 5000, 9500, 10000, 7406, 9314, 9500, 7000, 5000, 5000, 5000, 5000, 10000, 7186, 5000, 13500, 5000, 6542, 5307, 5500, 7400, 5000, 8061, 10980, 6000, 7476, 5500, 6000, 7655, 7888, 6107, 7033, 6781, 7500, 5500, 15037, 7666, 7500, 5506, 5500, 5547, 5000, 10000, 30000, 5523, 12000, 5000, 5000, 5000, 10000, 7500, 5344, 5000, 5000, 8500, 5000, 5000, 5000, 8000, 5500, 8445, 6500, 5500, 7617, 14739, 8236, 5000, 5000, 5552, 6667, 7000, 5943, 5000, 5000, 5000, 5000, 8500, 7000, 25000, 9872, 14335, 7820, 9000, 6382, 5000, 5000, 12000, 5000, 5000, 5000, 5000, 8000, 50500, 5000, 5000, 7500, 8000, 6500, 7000, 10894, 19525, 11000, 6366, 10000, 5588, 6694, 5000, 7000, 5000, 5000, 5000, 5500, 17500, 7000, 5000, 7500, 5000, 7363, 5000, 5000, 7000, 7256, 7500, 6614, 5887, 22000, 5000, 10000, 8000, 5000, 10000, 6516, 5000, 5000, 13500, 5500, 6500, 5000, 7387, 5000, 5000, 5500, 5461, 5000, 8500, 5000, 6000, 10000, 8500, 5000, 5000, 5000, 20500, 6053, 7514, 5000, 5000, 5000, 5000, 5000, 12000, 6402, 5000, 16500, 5000, 7047, 6500, 5000, 26962, 7000, 5500, 5500, 5000, 7323, 5000, 13500, 7500, 5000, 5000, 5000, 5000, 8621, 7237, 6251, 8411, 12000, 7500, 7500, 5000, 5000, 15500, 5000, 9000, 5500, 5000, 5500, 7117, 5000, 5444, 5000, 5500, 5000, 5000, 25106, 6055, 6500, 5500, 5000, 5000, 5000, 5815, 9500, 5682, 10500, 7000, 5000, 5000, 5000, 21039, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 11000, 5000, 5587, 15694, 5000, 5000, 17209, 5000, 5000, 5000, 5000, 5000, 6287, 6002, 8853, 6538, 5000, 5999, 5000, 5500, 6341, 7514, 5000, 5000, 5000, 5983, 5000, 5000, 5000, 5000, 5000, 10500, 5000, 7500, 5000, 5000, 5716, 5754, 20724, 5000, 14500, 5000, 5207, 6876, 9000, 5000, 5000, 5796, 5000, 6000, 7245, 5000, 5000, 5000, 5504, 6795, 17723, 19907, 5000, 5000, 5000, 5000, 6000, 8500, 5500, 22500, 5000, 7595, 5000, 19500, 7000, 5000, 5000, 6500, 5878, 8000, 11000, 8298, 6522, 5000, 6500, 8000, 6384, 6500, 6000, 7133, 9500, 6500, 6500, 8500, 6000, 5892, 5000, 10500, 5747, 5000, 5803, 5559, 5357, 5000, 9500, 8500, 6264, 6500, 17668, 5000, 5000, 10000, 6224, 10000, 5000, 5000, 6394, 6000, 6000, 5000, 22105, 6500, 5000, 5000, 22573, 11471, 9000, 5000, 5000, 7500, 5000, 9000, 5126, 7025, 5000, 5000, 5000, 5000, 8387, 6018, 5000, 7000, 9966, 16475, 6500, 20822, 5000, 6500, 5000, 7000, 5000, 9000, 5000, 5839, 5000, 10500, 5000, 5000, 6000, 12500, 5000, 5000, 9000, 7000, 6177, 7617, 7000, 5500, 5000, 8785, 6000, 10500, 7500, 7086, 5000, 5500, 5000, 10000, 5000, 5000, 5000, 7500, 10000, 5713, 5000, 10565, 5000, 6097, 5000, 6500, 5000, 7651, 8500, 5724, 6000, 10000, 7575, 15977, 25928, 8500, 17071, 7000, 26173, 6500, 15000, 6000, 5000, 5000, 5000, 6458, 5000, 7000, 5325, 5000, 5427, 7557, 7500, 5000, 5000, 5283, 7500, 5000, 9000, 17446, 8498, 5000, 5000, 10500, 5000, 5985, 5000, 10000, 6500, 6705, 5000, 5622, 9500, 5500, 5000, 18000, 17018, 5000, 8009, 5000, 5000, 6246, 7500, 9904, 5000, 5000, 5000, 5000, 11500, 6000, 10000, 5554, 5873, 5500, 6171, 5000, 9500, 6500, 5000, 8500, 6500, 6321, 5645, 6897, 5000, 8000, 5000, 6921, 17554, 19514, 5000, 6999, 9500, 5000, 10000, 5500, 7000, 9975, 5500, 7500, 5000, 5000, 5000, 9000, 5500, 6373, 5000, 5000, 5000, 6804, 7775, 5254, 5000, 5000, 5000, 17296, 11500, 10000, 9000, 5417, 10000, 5000, 5000, 7827, 6500, 5000, 5000, 15000, 7000, 8000, 5000, 5000, 6500, 5000, 13000, 5000, 5592, 5000, 10000, 5898, 5000, 5000, 5898, 5640, 5000, 6387, 5000, 12500, 10000, 5000, 5000, 13345, 36500, 6000, 5000, 6000, 6565, 5000, 15924, 5000, 5000, 7632, 5000, 7500, 6772, 5000, 6500, 5000, 5500, 5000, 5821, 6045, 20500, 6451, 7000, 6761, 5963, 5000, 9427, 6500, 5000, 5000, 5000, 10000, 5000, 5677, 5794, 5000, 10516, 5000, 13000, 6500, 12230, 5746, 19221, 8854, 5000, 6000, 5000, 8000, 6965, 6778, 7500, 5425, 7747, 6397, 5537, 26436, 7500, 12000, 8000, 7000, 5000, 5000, 9402, 5000, 5414, 5000, 5926, 5000, 6500, 17174, 5000, 6061, 5000, 11000, 6000, 14000, 10500, 5000, 5000, 5278, 6477, 5499, 15500, 5584, 5000, 7500, 5000, 5000, 8304, 5000, 5187, 5306, 7648, 10000, 8000, 5000, 6000, 5000, 6500, 23000, 5246, 5907, 5000, 17500, 6500, 15561, 6171, 5000, 5000, 19000, 9000, 8500, 16763, 8000, 12500, 5974, 5000, 9000, 5971, 19500, 15500, 7499, 5000, 12000, 5000, 7500, 5000, 10500, 5000, 14500, 6616, 5000, 15500, 5000, 5000, 23368, 26788, 5000, 14854, 5000, 10500, 5000, 5000, 5000, 5000, 7000, 16504, 5500, 5558, 5500, 5000, 5000, 5000, 5000, 35500, 5000, 5684, 5000, 5502, 5571, 6000, 21950, 6000, 26093, 13000, 5000, 5000, 5000, 5000, 5000, 5500, 5500, 5999, 5000, 5000, 5000, 5000, 7000, 8000, 26531, 7000, 18488]
> 72000
> 3000

可以看出，实际最长纪录的采样点为72000个，也就是72000/500Hz=144s，最短记录的采样点是3000个，也就是3000/500Hz=6s，官方给出的说明是6s-60s，但实际上最大有144s。

### 1.2抽离性别和年龄

将所有6877个mat数据中的性别和年龄保存为一个csv文件。

~~~python
import os
import numpy as np
import scipy.io as sio
import pandas as pd
import csv

mat_path = 'D:/data-set/12leadsECG/TrainingSet/'
npy_path = 'D:/data-set/12leadsECG/TrainingSet/1Data_npy/1age_male.csv'

mat_files = os.listdir(mat_path)
mat_name = []
age_name = []
male_name = []

for i in range(len(mat_files)):
    file_name = mat_files[i]
    if file_name.endswith('.mat'):
        key_name = file_name[0:5] # 取名字
    else:
        continue
    a = sio.loadmat(mat_path + file_name)
    # data = a['ECG'][0]['data'][0]
    age = a['ECG'][0]['age'][0][0][0]
    male = a['ECG'][0]['sex'][0][0]
    if male=="Male":
        male = 1
    else:
        male = 0
    mat_name.append(key_name+'.npy')
    age_name.append(age)
    male_name.append(male)

info = [age_name,male_name]
a = pd.DataFrame(columns=mat_name,data=info)
a.to_csv(npy_path,encoding='utf-8')
~~~

注：csv文件中保存两行数据，第一行为年龄，第二行为性别，男性为0，女性为1。

最终的保存格式如下：

![1611743837167](C:\Users\13018\AppData\Roaming\Typora\typora-user-images\1611743837167.png)

### 1.3对数据进行下采样

500Hz采样到250Hz

分离出来的npy文件的采样率是按照官方的采样率500Hz进行保存，但是大的采样率不利于计算，我们可以用降采样的方式将采样率降低为250Hz。最简单的理解就是将npy的采样点减一半即可。

采样使用``scipy.signal.resample``函数，传入参数重采样的矩阵，重采样的大小和维度。

~~~python
from scipy.signal import resample
import numpy as np
import matplotlib.pyplot as plt
a = np.load('D:/data-set/12leadsECG/TrainingSet/1Data_npy/A0001.npy')
b = resample(a,int(a.shape[1]/2),axis=1)
a_1 = a[1]
b_1 = b[1]
plt.plot(a_1, color='red')
plt.plot(b_1, color='blue')
plt.show()
~~~

![1611747598099](C:\Users\13018\AppData\Roaming\Typora\typora-user-images\1611747598099.png)

### 1.4制作标签数据

标签数据存放在REFERENCE.csv文件中，每条记录最多有三个分类。 数据集共包含了9类，分别为正常（Normal），心房颤动（Atrial fibrillation，AF），I度房室阻滞（First-degree atrioventricular block，I-AVB），左束支阻滞（Left bundle branch block，LBBB），右束支阻滞（Right bundle branch block，RBBB），房性早搏（Premature atrial contraction，PAC），室性早搏（Premature ventricular contraction，PVC），ST段降低（ST-segment depression，STD），ST段抬升（ST-segment elevated，STE） 。

采取标签的准则：由于每条记录最多有三个标签，官方给出的说明的只要任意识别为其中的一个种类就算正确，在这里我使用的标签数据one-hot类型的，所有我只取了标签分类中的`First_label`中的所有标签记录。忽略了`Second_label`和`Third_Label`。

~~~python
import os
import numpy as np
np.set_printoptions(threshold=np.inf)
import scipy.io as sio
import matplotlib.pyplot as plt
import pandas as pd

csv_path = 'D:/data-set/12leadsECG/TrainingSet/REFERENCE.csv'
label_npy_path = 'D:/data-set/12leadsECG/TrainingSet/1Record_Label.npy'
def get_label(csv_path, label_npy_path):
    a = pd.read_csv(csv_path)
    label = []
    for i in range(len(a['First_label'][:])):
        label.append(a['First_label'][i])
    print(label)
    np.save(label_npy_path, label)

get_label(csv_path, label_npy_path)
~~~

在此标签下，9个分类的标签数据的个数分别为918、1098、704、207、1695、574、653、826、202。分类数据样本数据不平衡，会对学习造成一定的困扰，所以可以通过扩充样本数据使各类型个数趋于一致。

### 1.5样本类型个数扩充

以9类样本的最大值为标准，各种类的采样率为：

~~~python
upsample_rate = max(num_categories) / np.array(num_categories) - 1
~~~

采样率在0-1之间的，样本扩充为records+oversample_size。

```
oversample_size = int(np.ceil(num_categories[i] * rate))
```

样本率>1的，样本扩充为：

~~~python
over_sample_records = []
over_sample_labels = []
for i in range(num_records):
    rate = upsample_rate[int(labels[i])]
    if rate >= 1:
        over_sample_records = over_sample_records + [records[i]] * int(round(rate)) # round返回rate的四舍五入的值,[records[i],,,,,] rate个
        over_sample_labels = over_sample_labels + [labels[i]] * int(round(rate))
records = np.concatenate((records, np.array(over_sample_records)))
labels = np.concatenate((labels, np.array(over_sample_labels)))
~~~

### 1.6样本切片（同时滤波）

由于样本的时常在6s-144s之间，我们可以把样本切片为6s，每条记录切取24个片段，对于144s的记录，24个切片之间不会有重叠的部分，但是对于对于小于144s的数据，采取以下的方式计算重叠部分的长度：

 ![img](https://img-blog.csdnimg.cn/20181231235058876.PNG) 

采样率为*fs* = 250 Hz，记录实际长度为*L*， 需要切取的片段数为*n* = 24，ol为重叠长度。

~~~python
overlap_length = int(seg_length - (len(sig) - seg_length) / (seg_num - 1))
~~~

切片完成之后的训练数据的大小是（1，1500，24），意义可以理解为每个样本24个通道，每个通道1500个采样点。

### 1.7所有数据进行z-score化

对信号进行均值为0，标准差为1的处理。

~~~python
for j in range(train_x.shape[0]):
    train_x[j, :, :] = scale(train_x[j, :, :], axis=0)
for j in range(val_x.shape[0]):
    val_x[j, :, :] = scale(val_x[j, :, :], axis=0)
~~~

## 2.建立模型

### 2.1对单导联进行训练

每个导联被切成24个6秒的片段。

以Ⅱ导联为例子，样本集的形状为train_X（9808，1500，24），train_Y（9808，9），val_X（2389，1500，24），val_Y（2389，9）

投入神经网络的input形状为（None，1500，24）

神经网络的结构为：

~~~python
branches = []
for i in range(int(inputs.shape[-1])):
	ld = Lambda(Net.__slice, output_shape=(int(inputs.shape[1]), 1), arguments={'index': i})(inputs)
    ld = Reshape((int(inputs.shape[1]), 1))(ld)
    bch = Net.__backbone(ld)
    branches.append(bch)
features = Concatenate(axis=1)(branches)
features = Dropout(keep_prob, [1, int(inputs.shape[-1]), 1])(features)
features = Bidirectional(CuDNNLSTM(1, return_sequences=True), merge_mode='concat')(features)
features = Flatten()(features)
net = Dense(units=num_classes, activation='softmax')(features)
~~~

针对24通道的每一通道都有如下的网络结构：

``input(None,1500,1)->Lambad(None,1500,1)->reshape(None,1500,1)->Conv1D(4,31,same)->BN->Activation(relu)->AveragePooling1D(5)->Conv1D(8,11,same)->BN->Activation(relu)->AveragePooling1D(5)->Conv1D(8,7,same)->BN->Activation(relu)->AveragePooling1D(5)->Conv1D(16,5,same)->BN->Activation(relu)->AveragePooling1D(net.shape[1])->Concatenate(把24个池化的结果在第1维拼接)->Dropout(0.5)->Bidirectional(CuDNNLSTM())->Flatten->dense(softmax)``

Layer                                       Output Shape        Param  Connected to                     

input_1 (InputLayer)            (None, 1500, 24)     0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_7 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_8 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_9 (Lambda)               (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_10 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_11 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_12 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_13 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_14 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_15 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_16 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_17 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_18 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_19 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_20 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_21 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_22 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_23 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_24 (Lambda)              (None, 1500, 1)      0           input_1[0][0]                    
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1500, 1)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 1500, 1)      0           lambda_2[0][0]                   
__________________________________________________________________________________________________
reshape_3 (Reshape)             (None, 1500, 1)      0           lambda_3[0][0]                   
__________________________________________________________________________________________________
reshape_4 (Reshape)             (None, 1500, 1)      0           lambda_4[0][0]                   
__________________________________________________________________________________________________
reshape_5 (Reshape)             (None, 1500, 1)      0           lambda_5[0][0]                   
__________________________________________________________________________________________________
reshape_6 (Reshape)             (None, 1500, 1)      0           lambda_6[0][0]                   
__________________________________________________________________________________________________
reshape_7 (Reshape)             (None, 1500, 1)      0           lambda_7[0][0]                   
__________________________________________________________________________________________________
reshape_8 (Reshape)             (None, 1500, 1)      0           lambda_8[0][0]                   
__________________________________________________________________________________________________
reshape_9 (Reshape)             (None, 1500, 1)      0           lambda_9[0][0]                   
__________________________________________________________________________________________________
reshape_10 (Reshape)            (None, 1500, 1)      0           lambda_10[0][0]                  
__________________________________________________________________________________________________
reshape_11 (Reshape)            (None, 1500, 1)      0           lambda_11[0][0]                  
__________________________________________________________________________________________________
reshape_12 (Reshape)            (None, 1500, 1)      0           lambda_12[0][0]                  
__________________________________________________________________________________________________
reshape_13 (Reshape)            (None, 1500, 1)      0           lambda_13[0][0]                  
__________________________________________________________________________________________________
reshape_14 (Reshape)            (None, 1500, 1)      0           lambda_14[0][0]                  
__________________________________________________________________________________________________
reshape_15 (Reshape)            (None, 1500, 1)      0           lambda_15[0][0]                  
__________________________________________________________________________________________________
reshape_16 (Reshape)            (None, 1500, 1)      0           lambda_16[0][0]                  
__________________________________________________________________________________________________
reshape_17 (Reshape)            (None, 1500, 1)      0           lambda_17[0][0]                  
__________________________________________________________________________________________________
reshape_18 (Reshape)            (None, 1500, 1)      0           lambda_18[0][0]                  
__________________________________________________________________________________________________
reshape_19 (Reshape)            (None, 1500, 1)      0           lambda_19[0][0]                  
__________________________________________________________________________________________________
reshape_20 (Reshape)            (None, 1500, 1)      0           lambda_20[0][0]                  
__________________________________________________________________________________________________
reshape_21 (Reshape)            (None, 1500, 1)      0           lambda_21[0][0]                  
__________________________________________________________________________________________________
reshape_22 (Reshape)            (None, 1500, 1)      0           lambda_22[0][0]                  
__________________________________________________________________________________________________
reshape_23 (Reshape)            (None, 1500, 1)      0           lambda_23[0][0]                  
__________________________________________________________________________________________________
reshape_24 (Reshape)            (None, 1500, 1)      0           lambda_24[0][0]                  
__________________________________________________________________________________________________
conv1d_1 (Conv1D)               (None, 1500, 4)      128         reshape_1[0][0]                  
__________________________________________________________________________________________________
conv1d_5 (Conv1D)               (None, 1500, 4)      128         reshape_2[0][0]                  
__________________________________________________________________________________________________
conv1d_9 (Conv1D)               (None, 1500, 4)      128         reshape_3[0][0]                  
__________________________________________________________________________________________________
conv1d_13 (Conv1D)              (None, 1500, 4)      128         reshape_4[0][0]                  
__________________________________________________________________________________________________
conv1d_17 (Conv1D)              (None, 1500, 4)      128         reshape_5[0][0]                  
__________________________________________________________________________________________________
conv1d_21 (Conv1D)              (None, 1500, 4)      128         reshape_6[0][0]                  
__________________________________________________________________________________________________
conv1d_25 (Conv1D)              (None, 1500, 4)      128         reshape_7[0][0]                  
__________________________________________________________________________________________________
conv1d_29 (Conv1D)              (None, 1500, 4)      128         reshape_8[0][0]                  
__________________________________________________________________________________________________
conv1d_33 (Conv1D)              (None, 1500, 4)      128         reshape_9[0][0]                  
__________________________________________________________________________________________________
conv1d_37 (Conv1D)              (None, 1500, 4)      128         reshape_10[0][0]                 
__________________________________________________________________________________________________
conv1d_41 (Conv1D)              (None, 1500, 4)      128         reshape_11[0][0]                 
__________________________________________________________________________________________________
conv1d_45 (Conv1D)              (None, 1500, 4)      128         reshape_12[0][0]                 
__________________________________________________________________________________________________
conv1d_49 (Conv1D)              (None, 1500, 4)      128         reshape_13[0][0]                 
__________________________________________________________________________________________________
conv1d_53 (Conv1D)              (None, 1500, 4)      128         reshape_14[0][0]                 
__________________________________________________________________________________________________
conv1d_57 (Conv1D)              (None, 1500, 4)      128         reshape_15[0][0]                 
__________________________________________________________________________________________________
conv1d_61 (Conv1D)              (None, 1500, 4)      128         reshape_16[0][0]                 
__________________________________________________________________________________________________
conv1d_65 (Conv1D)              (None, 1500, 4)      128         reshape_17[0][0]                 
__________________________________________________________________________________________________
conv1d_69 (Conv1D)              (None, 1500, 4)      128         reshape_18[0][0]                 
__________________________________________________________________________________________________
conv1d_73 (Conv1D)              (None, 1500, 4)      128         reshape_19[0][0]                 
__________________________________________________________________________________________________
conv1d_77 (Conv1D)              (None, 1500, 4)      128         reshape_20[0][0]                 
__________________________________________________________________________________________________
conv1d_81 (Conv1D)              (None, 1500, 4)      128         reshape_21[0][0]                 
__________________________________________________________________________________________________
conv1d_85 (Conv1D)              (None, 1500, 4)      128         reshape_22[0][0]                 
__________________________________________________________________________________________________
conv1d_89 (Conv1D)              (None, 1500, 4)      128         reshape_23[0][0]                 
__________________________________________________________________________________________________
conv1d_93 (Conv1D)              (None, 1500, 4)      128         reshape_24[0][0]                 
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 1500, 4)      16          conv1d_1[0][0]                   
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 1500, 4)      16          conv1d_5[0][0]                   
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 1500, 4)      16          conv1d_9[0][0]                   
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 1500, 4)      16          conv1d_13[0][0]                  
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 1500, 4)      16          conv1d_17[0][0]                  
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 1500, 4)      16          conv1d_21[0][0]                  
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 1500, 4)      16          conv1d_25[0][0]                  
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 1500, 4)      16          conv1d_29[0][0]                  
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 1500, 4)      16          conv1d_33[0][0]                  
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 1500, 4)      16          conv1d_37[0][0]                  
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 1500, 4)      16          conv1d_41[0][0]                  
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 1500, 4)      16          conv1d_45[0][0]                  
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 1500, 4)      16          conv1d_49[0][0]                  
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 1500, 4)      16          conv1d_53[0][0]                  
__________________________________________________________________________________________________
batch_normalization_57 (BatchNo (None, 1500, 4)      16          conv1d_57[0][0]                  
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, 1500, 4)      16          conv1d_61[0][0]                  
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, 1500, 4)      16          conv1d_65[0][0]                  
__________________________________________________________________________________________________
batch_normalization_69 (BatchNo (None, 1500, 4)      16          conv1d_69[0][0]                  
__________________________________________________________________________________________________
batch_normalization_73 (BatchNo (None, 1500, 4)      16          conv1d_73[0][0]                  
__________________________________________________________________________________________________
batch_normalization_77 (BatchNo (None, 1500, 4)      16          conv1d_77[0][0]                  
__________________________________________________________________________________________________
batch_normalization_81 (BatchNo (None, 1500, 4)      16          conv1d_81[0][0]                  
__________________________________________________________________________________________________
batch_normalization_85 (BatchNo (None, 1500, 4)      16          conv1d_85[0][0]                  
__________________________________________________________________________________________________
batch_normalization_89 (BatchNo (None, 1500, 4)      16          conv1d_89[0][0]                  
__________________________________________________________________________________________________
batch_normalization_93 (BatchNo (None, 1500, 4)      16          conv1d_93[0][0]                  
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 1500, 4)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 1500, 4)      0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 1500, 4)      0           batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 1500, 4)      0           batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 1500, 4)      0           batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 1500, 4)      0           batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 1500, 4)      0           batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 1500, 4)      0           batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 1500, 4)      0           batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 1500, 4)      0           batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 1500, 4)      0           batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 1500, 4)      0           batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 1500, 4)      0           batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 1500, 4)      0           batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 1500, 4)      0           batch_normalization_57[0][0]     
__________________________________________________________________________________________________
activation_61 (Activation)      (None, 1500, 4)      0           batch_normalization_61[0][0]     
__________________________________________________________________________________________________
activation_65 (Activation)      (None, 1500, 4)      0           batch_normalization_65[0][0]     
__________________________________________________________________________________________________
activation_69 (Activation)      (None, 1500, 4)      0           batch_normalization_69[0][0]     
__________________________________________________________________________________________________
activation_73 (Activation)      (None, 1500, 4)      0           batch_normalization_73[0][0]     
__________________________________________________________________________________________________
activation_77 (Activation)      (None, 1500, 4)      0           batch_normalization_77[0][0]     
__________________________________________________________________________________________________
activation_81 (Activation)      (None, 1500, 4)      0           batch_normalization_81[0][0]     
__________________________________________________________________________________________________
activation_85 (Activation)      (None, 1500, 4)      0           batch_normalization_85[0][0]     
__________________________________________________________________________________________________
activation_89 (Activation)      (None, 1500, 4)      0           batch_normalization_89[0][0]     
__________________________________________________________________________________________________
activation_93 (Activation)      (None, 1500, 4)      0           batch_normalization_93[0][0]     
__________________________________________________________________________________________________
average_pooling1d_1 (AveragePoo (None, 300, 4)       0           activation_1[0][0]               
__________________________________________________________________________________________________
average_pooling1d_5 (AveragePoo (None, 300, 4)       0           activation_5[0][0]               
__________________________________________________________________________________________________
average_pooling1d_9 (AveragePoo (None, 300, 4)       0           activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling1d_13 (AveragePo (None, 300, 4)       0           activation_13[0][0]              
__________________________________________________________________________________________________
average_pooling1d_17 (AveragePo (None, 300, 4)       0           activation_17[0][0]              
__________________________________________________________________________________________________
average_pooling1d_21 (AveragePo (None, 300, 4)       0           activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling1d_25 (AveragePo (None, 300, 4)       0           activation_25[0][0]              
__________________________________________________________________________________________________
average_pooling1d_29 (AveragePo (None, 300, 4)       0           activation_29[0][0]              
__________________________________________________________________________________________________
average_pooling1d_33 (AveragePo (None, 300, 4)       0           activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling1d_37 (AveragePo (None, 300, 4)       0           activation_37[0][0]              
__________________________________________________________________________________________________
average_pooling1d_41 (AveragePo (None, 300, 4)       0           activation_41[0][0]              
__________________________________________________________________________________________________
average_pooling1d_45 (AveragePo (None, 300, 4)       0           activation_45[0][0]              
__________________________________________________________________________________________________
average_pooling1d_49 (AveragePo (None, 300, 4)       0           activation_49[0][0]              
__________________________________________________________________________________________________
average_pooling1d_53 (AveragePo (None, 300, 4)       0           activation_53[0][0]              
__________________________________________________________________________________________________
average_pooling1d_57 (AveragePo (None, 300, 4)       0           activation_57[0][0]              
__________________________________________________________________________________________________
average_pooling1d_61 (AveragePo (None, 300, 4)       0           activation_61[0][0]              
__________________________________________________________________________________________________
average_pooling1d_65 (AveragePo (None, 300, 4)       0           activation_65[0][0]              
__________________________________________________________________________________________________
average_pooling1d_69 (AveragePo (None, 300, 4)       0           activation_69[0][0]              
__________________________________________________________________________________________________
average_pooling1d_73 (AveragePo (None, 300, 4)       0           activation_73[0][0]              
__________________________________________________________________________________________________
average_pooling1d_77 (AveragePo (None, 300, 4)       0           activation_77[0][0]              
__________________________________________________________________________________________________
average_pooling1d_81 (AveragePo (None, 300, 4)       0           activation_81[0][0]              
__________________________________________________________________________________________________
average_pooling1d_85 (AveragePo (None, 300, 4)       0           activation_85[0][0]              
__________________________________________________________________________________________________
average_pooling1d_89 (AveragePo (None, 300, 4)       0           activation_89[0][0]              
__________________________________________________________________________________________________
average_pooling1d_93 (AveragePo (None, 300, 4)       0           activation_93[0][0]              
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 300, 8)       360         average_pooling1d_1[0][0]        
__________________________________________________________________________________________________
conv1d_6 (Conv1D)               (None, 300, 8)       360         average_pooling1d_5[0][0]        
__________________________________________________________________________________________________
conv1d_10 (Conv1D)              (None, 300, 8)       360         average_pooling1d_9[0][0]        
__________________________________________________________________________________________________
conv1d_14 (Conv1D)              (None, 300, 8)       360         average_pooling1d_13[0][0]       
__________________________________________________________________________________________________
conv1d_18 (Conv1D)              (None, 300, 8)       360         average_pooling1d_17[0][0]       
__________________________________________________________________________________________________
conv1d_22 (Conv1D)              (None, 300, 8)       360         average_pooling1d_21[0][0]       
__________________________________________________________________________________________________
conv1d_26 (Conv1D)              (None, 300, 8)       360         average_pooling1d_25[0][0]       
__________________________________________________________________________________________________
conv1d_30 (Conv1D)              (None, 300, 8)       360         average_pooling1d_29[0][0]       
__________________________________________________________________________________________________
conv1d_34 (Conv1D)              (None, 300, 8)       360         average_pooling1d_33[0][0]       
__________________________________________________________________________________________________
conv1d_38 (Conv1D)              (None, 300, 8)       360         average_pooling1d_37[0][0]       
__________________________________________________________________________________________________
conv1d_42 (Conv1D)              (None, 300, 8)       360         average_pooling1d_41[0][0]       
__________________________________________________________________________________________________
conv1d_46 (Conv1D)              (None, 300, 8)       360         average_pooling1d_45[0][0]       
__________________________________________________________________________________________________
conv1d_50 (Conv1D)              (None, 300, 8)       360         average_pooling1d_49[0][0]       
__________________________________________________________________________________________________
conv1d_54 (Conv1D)              (None, 300, 8)       360         average_pooling1d_53[0][0]       
__________________________________________________________________________________________________
conv1d_58 (Conv1D)              (None, 300, 8)       360         average_pooling1d_57[0][0]       
__________________________________________________________________________________________________
conv1d_62 (Conv1D)              (None, 300, 8)       360         average_pooling1d_61[0][0]       
__________________________________________________________________________________________________
conv1d_66 (Conv1D)              (None, 300, 8)       360         average_pooling1d_65[0][0]       
__________________________________________________________________________________________________
conv1d_70 (Conv1D)              (None, 300, 8)       360         average_pooling1d_69[0][0]       
__________________________________________________________________________________________________
conv1d_74 (Conv1D)              (None, 300, 8)       360         average_pooling1d_73[0][0]       
__________________________________________________________________________________________________
conv1d_78 (Conv1D)              (None, 300, 8)       360         average_pooling1d_77[0][0]       
__________________________________________________________________________________________________
conv1d_82 (Conv1D)              (None, 300, 8)       360         average_pooling1d_81[0][0]       
__________________________________________________________________________________________________
conv1d_86 (Conv1D)              (None, 300, 8)       360         average_pooling1d_85[0][0]       
__________________________________________________________________________________________________
conv1d_90 (Conv1D)              (None, 300, 8)       360         average_pooling1d_89[0][0]       
__________________________________________________________________________________________________
conv1d_94 (Conv1D)              (None, 300, 8)       360         average_pooling1d_93[0][0]       
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 300, 8)       32          conv1d_2[0][0]                   
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 300, 8)       32          conv1d_6[0][0]                   
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 300, 8)       32          conv1d_10[0][0]                  
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 300, 8)       32          conv1d_14[0][0]                  
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 300, 8)       32          conv1d_18[0][0]                  
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 300, 8)       32          conv1d_22[0][0]                  
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 300, 8)       32          conv1d_26[0][0]                  
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 300, 8)       32          conv1d_30[0][0]                  
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 300, 8)       32          conv1d_34[0][0]                  
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 300, 8)       32          conv1d_38[0][0]                  
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 300, 8)       32          conv1d_42[0][0]                  
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 300, 8)       32          conv1d_46[0][0]                  
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 300, 8)       32          conv1d_50[0][0]                  
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 300, 8)       32          conv1d_54[0][0]                  
__________________________________________________________________________________________________
batch_normalization_58 (BatchNo (None, 300, 8)       32          conv1d_58[0][0]                  
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, 300, 8)       32          conv1d_62[0][0]                  
__________________________________________________________________________________________________
batch_normalization_66 (BatchNo (None, 300, 8)       32          conv1d_66[0][0]                  
__________________________________________________________________________________________________
batch_normalization_70 (BatchNo (None, 300, 8)       32          conv1d_70[0][0]                  
__________________________________________________________________________________________________
batch_normalization_74 (BatchNo (None, 300, 8)       32          conv1d_74[0][0]                  
__________________________________________________________________________________________________
batch_normalization_78 (BatchNo (None, 300, 8)       32          conv1d_78[0][0]                  
__________________________________________________________________________________________________
batch_normalization_82 (BatchNo (None, 300, 8)       32          conv1d_82[0][0]                  
__________________________________________________________________________________________________
batch_normalization_86 (BatchNo (None, 300, 8)       32          conv1d_86[0][0]                  
__________________________________________________________________________________________________
batch_normalization_90 (BatchNo (None, 300, 8)       32          conv1d_90[0][0]                  
__________________________________________________________________________________________________
batch_normalization_94 (BatchNo (None, 300, 8)       32          conv1d_94[0][0]                  
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 300, 8)       0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 300, 8)       0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 300, 8)       0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 300, 8)       0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 300, 8)       0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 300, 8)       0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 300, 8)       0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 300, 8)       0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 300, 8)       0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 300, 8)       0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 300, 8)       0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 300, 8)       0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 300, 8)       0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 300, 8)       0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 300, 8)       0           batch_normalization_58[0][0]     
__________________________________________________________________________________________________
activation_62 (Activation)      (None, 300, 8)       0           batch_normalization_62[0][0]     
__________________________________________________________________________________________________
activation_66 (Activation)      (None, 300, 8)       0           batch_normalization_66[0][0]     
__________________________________________________________________________________________________
activation_70 (Activation)      (None, 300, 8)       0           batch_normalization_70[0][0]     
__________________________________________________________________________________________________
activation_74 (Activation)      (None, 300, 8)       0           batch_normalization_74[0][0]     
__________________________________________________________________________________________________
activation_78 (Activation)      (None, 300, 8)       0           batch_normalization_78[0][0]     
__________________________________________________________________________________________________
activation_82 (Activation)      (None, 300, 8)       0           batch_normalization_82[0][0]     
__________________________________________________________________________________________________
activation_86 (Activation)      (None, 300, 8)       0           batch_normalization_86[0][0]     
__________________________________________________________________________________________________
activation_90 (Activation)      (None, 300, 8)       0           batch_normalization_90[0][0]     
__________________________________________________________________________________________________
activation_94 (Activation)      (None, 300, 8)       0           batch_normalization_94[0][0]     
__________________________________________________________________________________________________
average_pooling1d_2 (AveragePoo (None, 60, 8)        0           activation_2[0][0]               
__________________________________________________________________________________________________
average_pooling1d_6 (AveragePoo (None, 60, 8)        0           activation_6[0][0]               
__________________________________________________________________________________________________
average_pooling1d_10 (AveragePo (None, 60, 8)        0           activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling1d_14 (AveragePo (None, 60, 8)        0           activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling1d_18 (AveragePo (None, 60, 8)        0           activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling1d_22 (AveragePo (None, 60, 8)        0           activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling1d_26 (AveragePo (None, 60, 8)        0           activation_26[0][0]              
__________________________________________________________________________________________________
average_pooling1d_30 (AveragePo (None, 60, 8)        0           activation_30[0][0]              
__________________________________________________________________________________________________
average_pooling1d_34 (AveragePo (None, 60, 8)        0           activation_34[0][0]              
__________________________________________________________________________________________________
average_pooling1d_38 (AveragePo (None, 60, 8)        0           activation_38[0][0]              
__________________________________________________________________________________________________
average_pooling1d_42 (AveragePo (None, 60, 8)        0           activation_42[0][0]              
__________________________________________________________________________________________________
average_pooling1d_46 (AveragePo (None, 60, 8)        0           activation_46[0][0]              
__________________________________________________________________________________________________
average_pooling1d_50 (AveragePo (None, 60, 8)        0           activation_50[0][0]              
__________________________________________________________________________________________________
average_pooling1d_54 (AveragePo (None, 60, 8)        0           activation_54[0][0]              
__________________________________________________________________________________________________
average_pooling1d_58 (AveragePo (None, 60, 8)        0           activation_58[0][0]              
__________________________________________________________________________________________________
average_pooling1d_62 (AveragePo (None, 60, 8)        0           activation_62[0][0]              
__________________________________________________________________________________________________
average_pooling1d_66 (AveragePo (None, 60, 8)        0           activation_66[0][0]              
__________________________________________________________________________________________________
average_pooling1d_70 (AveragePo (None, 60, 8)        0           activation_70[0][0]              
__________________________________________________________________________________________________
average_pooling1d_74 (AveragePo (None, 60, 8)        0           activation_74[0][0]              
__________________________________________________________________________________________________
average_pooling1d_78 (AveragePo (None, 60, 8)        0           activation_78[0][0]              
__________________________________________________________________________________________________
average_pooling1d_82 (AveragePo (None, 60, 8)        0           activation_82[0][0]              
__________________________________________________________________________________________________
average_pooling1d_86 (AveragePo (None, 60, 8)        0           activation_86[0][0]              
__________________________________________________________________________________________________
average_pooling1d_90 (AveragePo (None, 60, 8)        0           activation_90[0][0]              
__________________________________________________________________________________________________
average_pooling1d_94 (AveragePo (None, 60, 8)        0           activation_94[0][0]              
__________________________________________________________________________________________________
conv1d_3 (Conv1D)               (None, 60, 8)        456         average_pooling1d_2[0][0]        
__________________________________________________________________________________________________
conv1d_7 (Conv1D)               (None, 60, 8)        456         average_pooling1d_6[0][0]        
__________________________________________________________________________________________________
conv1d_11 (Conv1D)              (None, 60, 8)        456         average_pooling1d_10[0][0]       
__________________________________________________________________________________________________
conv1d_15 (Conv1D)              (None, 60, 8)        456         average_pooling1d_14[0][0]       
__________________________________________________________________________________________________
conv1d_19 (Conv1D)              (None, 60, 8)        456         average_pooling1d_18[0][0]       
__________________________________________________________________________________________________
conv1d_23 (Conv1D)              (None, 60, 8)        456         average_pooling1d_22[0][0]       
__________________________________________________________________________________________________
conv1d_27 (Conv1D)              (None, 60, 8)        456         average_pooling1d_26[0][0]       
__________________________________________________________________________________________________
conv1d_31 (Conv1D)              (None, 60, 8)        456         average_pooling1d_30[0][0]       
__________________________________________________________________________________________________
conv1d_35 (Conv1D)              (None, 60, 8)        456         average_pooling1d_34[0][0]       
__________________________________________________________________________________________________
conv1d_39 (Conv1D)              (None, 60, 8)        456         average_pooling1d_38[0][0]       
__________________________________________________________________________________________________
conv1d_43 (Conv1D)              (None, 60, 8)        456         average_pooling1d_42[0][0]       
__________________________________________________________________________________________________
conv1d_47 (Conv1D)              (None, 60, 8)        456         average_pooling1d_46[0][0]       
__________________________________________________________________________________________________
conv1d_51 (Conv1D)              (None, 60, 8)        456         average_pooling1d_50[0][0]       
__________________________________________________________________________________________________
conv1d_55 (Conv1D)              (None, 60, 8)        456         average_pooling1d_54[0][0]       
__________________________________________________________________________________________________
conv1d_59 (Conv1D)              (None, 60, 8)        456         average_pooling1d_58[0][0]       
__________________________________________________________________________________________________
conv1d_63 (Conv1D)              (None, 60, 8)        456         average_pooling1d_62[0][0]       
__________________________________________________________________________________________________
conv1d_67 (Conv1D)              (None, 60, 8)        456         average_pooling1d_66[0][0]       
__________________________________________________________________________________________________
conv1d_71 (Conv1D)              (None, 60, 8)        456         average_pooling1d_70[0][0]       
__________________________________________________________________________________________________
conv1d_75 (Conv1D)              (None, 60, 8)        456         average_pooling1d_74[0][0]       
__________________________________________________________________________________________________
conv1d_79 (Conv1D)              (None, 60, 8)        456         average_pooling1d_78[0][0]       
__________________________________________________________________________________________________
conv1d_83 (Conv1D)              (None, 60, 8)        456         average_pooling1d_82[0][0]       
__________________________________________________________________________________________________
conv1d_87 (Conv1D)              (None, 60, 8)        456         average_pooling1d_86[0][0]       
__________________________________________________________________________________________________
conv1d_91 (Conv1D)              (None, 60, 8)        456         average_pooling1d_90[0][0]       
__________________________________________________________________________________________________
conv1d_95 (Conv1D)              (None, 60, 8)        456         average_pooling1d_94[0][0]       
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 60, 8)        32          conv1d_3[0][0]                   
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 60, 8)        32          conv1d_7[0][0]                   
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 60, 8)        32          conv1d_11[0][0]                  
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 60, 8)        32          conv1d_15[0][0]                  
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 60, 8)        32          conv1d_19[0][0]                  
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 60, 8)        32          conv1d_23[0][0]                  
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 60, 8)        32          conv1d_27[0][0]                  
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 60, 8)        32          conv1d_31[0][0]                  
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 60, 8)        32          conv1d_35[0][0]                  
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 60, 8)        32          conv1d_39[0][0]                  
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 60, 8)        32          conv1d_43[0][0]                  
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 60, 8)        32          conv1d_47[0][0]                  
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 60, 8)        32          conv1d_51[0][0]                  
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 60, 8)        32          conv1d_55[0][0]                  
__________________________________________________________________________________________________
batch_normalization_59 (BatchNo (None, 60, 8)        32          conv1d_59[0][0]                  
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 60, 8)        32          conv1d_63[0][0]                  
__________________________________________________________________________________________________
batch_normalization_67 (BatchNo (None, 60, 8)        32          conv1d_67[0][0]                  
__________________________________________________________________________________________________
batch_normalization_71 (BatchNo (None, 60, 8)        32          conv1d_71[0][0]                  
__________________________________________________________________________________________________
batch_normalization_75 (BatchNo (None, 60, 8)        32          conv1d_75[0][0]                  
__________________________________________________________________________________________________
batch_normalization_79 (BatchNo (None, 60, 8)        32          conv1d_79[0][0]                  
__________________________________________________________________________________________________
batch_normalization_83 (BatchNo (None, 60, 8)        32          conv1d_83[0][0]                  
__________________________________________________________________________________________________
batch_normalization_87 (BatchNo (None, 60, 8)        32          conv1d_87[0][0]                  
__________________________________________________________________________________________________
batch_normalization_91 (BatchNo (None, 60, 8)        32          conv1d_91[0][0]                  
__________________________________________________________________________________________________
batch_normalization_95 (BatchNo (None, 60, 8)        32          conv1d_95[0][0]                  
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 60, 8)        0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 60, 8)        0           batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 60, 8)        0           batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 60, 8)        0           batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 60, 8)        0           batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 60, 8)        0           batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 60, 8)        0           batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 60, 8)        0           batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 60, 8)        0           batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 60, 8)        0           batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 60, 8)        0           batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 60, 8)        0           batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 60, 8)        0           batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 60, 8)        0           batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_59 (Activation)      (None, 60, 8)        0           batch_normalization_59[0][0]     
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 60, 8)        0           batch_normalization_63[0][0]     
__________________________________________________________________________________________________
activation_67 (Activation)      (None, 60, 8)        0           batch_normalization_67[0][0]     
__________________________________________________________________________________________________
activation_71 (Activation)      (None, 60, 8)        0           batch_normalization_71[0][0]     
__________________________________________________________________________________________________
activation_75 (Activation)      (None, 60, 8)        0           batch_normalization_75[0][0]     
__________________________________________________________________________________________________
activation_79 (Activation)      (None, 60, 8)        0           batch_normalization_79[0][0]     
__________________________________________________________________________________________________
activation_83 (Activation)      (None, 60, 8)        0           batch_normalization_83[0][0]     
__________________________________________________________________________________________________
activation_87 (Activation)      (None, 60, 8)        0           batch_normalization_87[0][0]     
__________________________________________________________________________________________________
activation_91 (Activation)      (None, 60, 8)        0           batch_normalization_91[0][0]     
__________________________________________________________________________________________________
activation_95 (Activation)      (None, 60, 8)        0           batch_normalization_95[0][0]     
__________________________________________________________________________________________________
average_pooling1d_3 (AveragePoo (None, 12, 8)        0           activation_3[0][0]               
__________________________________________________________________________________________________
average_pooling1d_7 (AveragePoo (None, 12, 8)        0           activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling1d_11 (AveragePo (None, 12, 8)        0           activation_11[0][0]              
__________________________________________________________________________________________________
average_pooling1d_15 (AveragePo (None, 12, 8)        0           activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling1d_19 (AveragePo (None, 12, 8)        0           activation_19[0][0]              
__________________________________________________________________________________________________
average_pooling1d_23 (AveragePo (None, 12, 8)        0           activation_23[0][0]              
__________________________________________________________________________________________________
average_pooling1d_27 (AveragePo (None, 12, 8)        0           activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling1d_31 (AveragePo (None, 12, 8)        0           activation_31[0][0]              
__________________________________________________________________________________________________
average_pooling1d_35 (AveragePo (None, 12, 8)        0           activation_35[0][0]              
__________________________________________________________________________________________________
average_pooling1d_39 (AveragePo (None, 12, 8)        0           activation_39[0][0]              
__________________________________________________________________________________________________
average_pooling1d_43 (AveragePo (None, 12, 8)        0           activation_43[0][0]              
__________________________________________________________________________________________________
average_pooling1d_47 (AveragePo (None, 12, 8)        0           activation_47[0][0]              
__________________________________________________________________________________________________
average_pooling1d_51 (AveragePo (None, 12, 8)        0           activation_51[0][0]              
__________________________________________________________________________________________________
average_pooling1d_55 (AveragePo (None, 12, 8)        0           activation_55[0][0]              
__________________________________________________________________________________________________
average_pooling1d_59 (AveragePo (None, 12, 8)        0           activation_59[0][0]              
__________________________________________________________________________________________________
average_pooling1d_63 (AveragePo (None, 12, 8)        0           activation_63[0][0]              
__________________________________________________________________________________________________
average_pooling1d_67 (AveragePo (None, 12, 8)        0           activation_67[0][0]              
__________________________________________________________________________________________________
average_pooling1d_71 (AveragePo (None, 12, 8)        0           activation_71[0][0]              
__________________________________________________________________________________________________
average_pooling1d_75 (AveragePo (None, 12, 8)        0           activation_75[0][0]              
__________________________________________________________________________________________________
average_pooling1d_79 (AveragePo (None, 12, 8)        0           activation_79[0][0]              
__________________________________________________________________________________________________
average_pooling1d_83 (AveragePo (None, 12, 8)        0           activation_83[0][0]              
__________________________________________________________________________________________________
average_pooling1d_87 (AveragePo (None, 12, 8)        0           activation_87[0][0]              
__________________________________________________________________________________________________
average_pooling1d_91 (AveragePo (None, 12, 8)        0           activation_91[0][0]              
__________________________________________________________________________________________________
average_pooling1d_95 (AveragePo (None, 12, 8)        0           activation_95[0][0]              
__________________________________________________________________________________________________
conv1d_4 (Conv1D)               (None, 12, 16)       656         average_pooling1d_3[0][0]        
__________________________________________________________________________________________________
conv1d_8 (Conv1D)               (None, 12, 16)       656         average_pooling1d_7[0][0]        
__________________________________________________________________________________________________
conv1d_12 (Conv1D)              (None, 12, 16)       656         average_pooling1d_11[0][0]       
__________________________________________________________________________________________________
conv1d_16 (Conv1D)              (None, 12, 16)       656         average_pooling1d_15[0][0]       
__________________________________________________________________________________________________
conv1d_20 (Conv1D)              (None, 12, 16)       656         average_pooling1d_19[0][0]       
__________________________________________________________________________________________________
conv1d_24 (Conv1D)              (None, 12, 16)       656         average_pooling1d_23[0][0]       
__________________________________________________________________________________________________
conv1d_28 (Conv1D)              (None, 12, 16)       656         average_pooling1d_27[0][0]       
__________________________________________________________________________________________________
conv1d_32 (Conv1D)              (None, 12, 16)       656         average_pooling1d_31[0][0]       
__________________________________________________________________________________________________
conv1d_36 (Conv1D)              (None, 12, 16)       656         average_pooling1d_35[0][0]       
__________________________________________________________________________________________________
conv1d_40 (Conv1D)              (None, 12, 16)       656         average_pooling1d_39[0][0]       
__________________________________________________________________________________________________
conv1d_44 (Conv1D)              (None, 12, 16)       656         average_pooling1d_43[0][0]       
__________________________________________________________________________________________________
conv1d_48 (Conv1D)              (None, 12, 16)       656         average_pooling1d_47[0][0]       
__________________________________________________________________________________________________
conv1d_52 (Conv1D)              (None, 12, 16)       656         average_pooling1d_51[0][0]       
__________________________________________________________________________________________________
conv1d_56 (Conv1D)              (None, 12, 16)       656         average_pooling1d_55[0][0]       
__________________________________________________________________________________________________
conv1d_60 (Conv1D)              (None, 12, 16)       656         average_pooling1d_59[0][0]       
__________________________________________________________________________________________________
conv1d_64 (Conv1D)              (None, 12, 16)       656         average_pooling1d_63[0][0]       
__________________________________________________________________________________________________
conv1d_68 (Conv1D)              (None, 12, 16)       656         average_pooling1d_67[0][0]       
__________________________________________________________________________________________________
conv1d_72 (Conv1D)              (None, 12, 16)       656         average_pooling1d_71[0][0]       
__________________________________________________________________________________________________
conv1d_76 (Conv1D)              (None, 12, 16)       656         average_pooling1d_75[0][0]       
__________________________________________________________________________________________________
conv1d_80 (Conv1D)              (None, 12, 16)       656         average_pooling1d_79[0][0]       
__________________________________________________________________________________________________
conv1d_84 (Conv1D)              (None, 12, 16)       656         average_pooling1d_83[0][0]       
__________________________________________________________________________________________________
conv1d_88 (Conv1D)              (None, 12, 16)       656         average_pooling1d_87[0][0]       
__________________________________________________________________________________________________
conv1d_92 (Conv1D)              (None, 12, 16)       656         average_pooling1d_91[0][0]       
__________________________________________________________________________________________________
conv1d_96 (Conv1D)              (None, 12, 16)       656         average_pooling1d_95[0][0]       
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 12, 16)       64          conv1d_4[0][0]                   
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 12, 16)       64          conv1d_8[0][0]                   
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 12, 16)       64          conv1d_12[0][0]                  
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 12, 16)       64          conv1d_16[0][0]                  
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 12, 16)       64          conv1d_20[0][0]                  
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 12, 16)       64          conv1d_24[0][0]                  
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 12, 16)       64          conv1d_28[0][0]                  
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 12, 16)       64          conv1d_32[0][0]                  
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 12, 16)       64          conv1d_36[0][0]                  
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 12, 16)       64          conv1d_40[0][0]                  
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 12, 16)       64          conv1d_44[0][0]                  
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 12, 16)       64          conv1d_48[0][0]                  
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 12, 16)       64          conv1d_52[0][0]                  
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, 12, 16)       64          conv1d_56[0][0]                  
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, 12, 16)       64          conv1d_60[0][0]                  
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, 12, 16)       64          conv1d_64[0][0]                  
__________________________________________________________________________________________________
batch_normalization_68 (BatchNo (None, 12, 16)       64          conv1d_68[0][0]                  
__________________________________________________________________________________________________
batch_normalization_72 (BatchNo (None, 12, 16)       64          conv1d_72[0][0]                  
__________________________________________________________________________________________________
batch_normalization_76 (BatchNo (None, 12, 16)       64          conv1d_76[0][0]                  
__________________________________________________________________________________________________
batch_normalization_80 (BatchNo (None, 12, 16)       64          conv1d_80[0][0]                  
__________________________________________________________________________________________________
batch_normalization_84 (BatchNo (None, 12, 16)       64          conv1d_84[0][0]                  
__________________________________________________________________________________________________
batch_normalization_88 (BatchNo (None, 12, 16)       64          conv1d_88[0][0]                  
__________________________________________________________________________________________________
batch_normalization_92 (BatchNo (None, 12, 16)       64          conv1d_92[0][0]                  
__________________________________________________________________________________________________
batch_normalization_96 (BatchNo (None, 12, 16)       64          conv1d_96[0][0]                  
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 12, 16)       0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 12, 16)       0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 12, 16)       0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 12, 16)       0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 12, 16)       0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 12, 16)       0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 12, 16)       0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 12, 16)       0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 12, 16)       0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 12, 16)       0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 12, 16)       0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 12, 16)       0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 12, 16)       0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 12, 16)       0           batch_normalization_56[0][0]     
__________________________________________________________________________________________________
activation_60 (Activation)      (None, 12, 16)       0           batch_normalization_60[0][0]     
__________________________________________________________________________________________________
activation_64 (Activation)      (None, 12, 16)       0           batch_normalization_64[0][0]     
__________________________________________________________________________________________________
activation_68 (Activation)      (None, 12, 16)       0           batch_normalization_68[0][0]     
__________________________________________________________________________________________________
activation_72 (Activation)      (None, 12, 16)       0           batch_normalization_72[0][0]     
__________________________________________________________________________________________________
activation_76 (Activation)      (None, 12, 16)       0           batch_normalization_76[0][0]     
__________________________________________________________________________________________________
activation_80 (Activation)      (None, 12, 16)       0           batch_normalization_80[0][0]     
__________________________________________________________________________________________________
activation_84 (Activation)      (None, 12, 16)       0           batch_normalization_84[0][0]     
__________________________________________________________________________________________________
activation_88 (Activation)      (None, 12, 16)       0           batch_normalization_88[0][0]     
__________________________________________________________________________________________________
activation_92 (Activation)      (None, 12, 16)       0           batch_normalization_92[0][0]     
__________________________________________________________________________________________________
activation_96 (Activation)      (None, 12, 16)       0           batch_normalization_96[0][0]     
__________________________________________________________________________________________________
average_pooling1d_4 (AveragePoo (None, 1, 16)        0           activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling1d_8 (AveragePoo (None, 1, 16)        0           activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling1d_12 (AveragePo (None, 1, 16)        0           activation_12[0][0]              
__________________________________________________________________________________________________
average_pooling1d_16 (AveragePo (None, 1, 16)        0           activation_16[0][0]              
__________________________________________________________________________________________________
average_pooling1d_20 (AveragePo (None, 1, 16)        0           activation_20[0][0]              
__________________________________________________________________________________________________
average_pooling1d_24 (AveragePo (None, 1, 16)        0           activation_24[0][0]              
__________________________________________________________________________________________________
average_pooling1d_28 (AveragePo (None, 1, 16)        0           activation_28[0][0]              
__________________________________________________________________________________________________
average_pooling1d_32 (AveragePo (None, 1, 16)        0           activation_32[0][0]              
__________________________________________________________________________________________________
average_pooling1d_36 (AveragePo (None, 1, 16)        0           activation_36[0][0]              
__________________________________________________________________________________________________
average_pooling1d_40 (AveragePo (None, 1, 16)        0           activation_40[0][0]              
__________________________________________________________________________________________________
average_pooling1d_44 (AveragePo (None, 1, 16)        0           activation_44[0][0]              
__________________________________________________________________________________________________
average_pooling1d_48 (AveragePo (None, 1, 16)        0           activation_48[0][0]              
__________________________________________________________________________________________________
average_pooling1d_52 (AveragePo (None, 1, 16)        0           activation_52[0][0]              
__________________________________________________________________________________________________
average_pooling1d_56 (AveragePo (None, 1, 16)        0           activation_56[0][0]              
__________________________________________________________________________________________________
average_pooling1d_60 (AveragePo (None, 1, 16)        0           activation_60[0][0]              
__________________________________________________________________________________________________
average_pooling1d_64 (AveragePo (None, 1, 16)        0           activation_64[0][0]              
__________________________________________________________________________________________________
average_pooling1d_68 (AveragePo (None, 1, 16)        0           activation_68[0][0]              
__________________________________________________________________________________________________
average_pooling1d_72 (AveragePo (None, 1, 16)        0           activation_72[0][0]              
__________________________________________________________________________________________________
average_pooling1d_76 (AveragePo (None, 1, 16)        0           activation_76[0][0]              
__________________________________________________________________________________________________
average_pooling1d_80 (AveragePo (None, 1, 16)        0           activation_80[0][0]              
__________________________________________________________________________________________________
average_pooling1d_84 (AveragePo (None, 1, 16)        0           activation_84[0][0]              
__________________________________________________________________________________________________
average_pooling1d_88 (AveragePo (None, 1, 16)        0           activation_88[0][0]              
__________________________________________________________________________________________________
average_pooling1d_92 (AveragePo (None, 1, 16)        0           activation_92[0][0]              
__________________________________________________________________________________________________
average_pooling1d_96 (AveragePo (None, 1, 16)        0           activation_96[0][0]              
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 24, 16)       0           average_pooling1d_4[0][0]        
                                                                 average_pooling1d_8[0][0]        
                                                                 average_pooling1d_12[0][0]       
                                                                 average_pooling1d_16[0][0]       
                                                                 average_pooling1d_20[0][0]       
                                                                 average_pooling1d_24[0][0]       
                                                                 average_pooling1d_28[0][0]       
                                                                 average_pooling1d_32[0][0]       
                                                                 average_pooling1d_36[0][0]       
                                                                 average_pooling1d_40[0][0]       
                                                                 average_pooling1d_44[0][0]       
                                                                 average_pooling1d_48[0][0]       
                                                                 average_pooling1d_52[0][0]       
                                                                 average_pooling1d_56[0][0]       
                                                                 average_pooling1d_60[0][0]       
                                                                 average_pooling1d_64[0][0]       
                                                                 average_pooling1d_68[0][0]       
                                                                 average_pooling1d_72[0][0]       
                                                                 average_pooling1d_76[0][0]       
                                                                 average_pooling1d_80[0][0]       
                                                                 average_pooling1d_84[0][0]       
                                                                 average_pooling1d_88[0][0]       
                                                                 average_pooling1d_92[0][0]       
                                                                 average_pooling1d_96[0][0]       

__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 16)       0           concatenate_1[0][0]              
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 24, 2)        152         dropout_1[0][0]                  
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 48)           0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 9)            441         flatten_1[0][0]                  

Total params: 42,449
Trainable params: 40,721

### 2.2提取人工特征

心率变异性（Heart Rate Variability，HRV）分析是一个足够鲁棒的选择，同时，HRV分析在房颤，早搏等异常诊断上也常有应用，也有其相应的医学意义。

从另一方面来看，以往使用CNN自动学习特征。CNN的长处在于局部细节特征的提取，而HRV分析中的特征，例如计算RR间期的标准差，是一个典型的统计特征，显然CNN对类似的特征并未有特殊的设计。所以，在我们前面的深度学习网络基础上，补充一些HRV特征，或是跟RR间期相关的统计特征，能形成比较良好的互补，起码在直觉和理论上是这样的。因此，我引入了下面的一些特征。因为所有导联是同时采集的，在时间上是完全平行的，所以以下特征均以II导联为基准（也就是人工特征只采取十二导联中的某一个导联即可）：

1. RR间期标准差
2. 最大RR间期
3. 最小RR间期
4. 平均RR间期
5. pNN50:相邻RR间期差距大于50ms的比率
6. R波密度：R波个数/记录长度
7. RMSSD：相邻RR间期差值的均方根
8. RR间期的采样熵：衡量RR间期变化混乱度

另外数据库也提供了每条记录所属个体的年龄和性别，这里也把这2个特征引入进来。

~~~python
class ManFeat_HRV(object):
    """
        针对一条记录的HRV特征提取， 以II导联为基准
    """
    FEAT_DIMENSION = 9

    def __init__(self, sig, fs=250.0):
        assert len(sig.shape) == 1, 'The signal must be 1-dimension.'
        assert sig.shape[0] >= fs * 6, 'The signal must >= 6 seconds.'
        self.sig = utils.WTfilt_1d(sig)
        self.fs = fs
        self.rpeaks, = ecg.hamilton_segmenter(signal=self.sig, sampling_rate=self.fs)
        self.rpeaks, = ecg.correct_rpeaks(signal=self.sig, rpeaks=self.rpeaks,
                                          sampling_rate=self.fs)
        self.RR_intervals = np.diff(self.rpeaks)
        self.dRR = np.diff(self.RR_intervals)

    def __get_sdnn(self):  # 计算RR间期标准差
        return np.array([np.std(self.RR_intervals)])

    def __get_maxRR(self):  # 计算最大RR间期
        return np.array([np.max(self.RR_intervals)])

    def __get_minRR(self):  # 计算最小RR间期
        return np.array([np.min(self.RR_intervals)])

    def __get_meanRR(self):  # 计算平均RR间期
        return np.array([np.mean(self.RR_intervals)])

    def __get_Rdensity(self):  # 计算R波密度
        return np.array([(self.RR_intervals.shape[0] + 1)
                         / self.sig.shape[0] * self.fs])

    def __get_pNN50(self):  # 计算pNN50
        return np.array([self.dRR[self.dRR >= self.fs * 0.05].shape[0]
                         / self.RR_intervals.shape[0]])

    def __get_RMSSD(self):  # 计算RMSSD
        return np.array([np.sqrt(np.mean(self.dRR * self.dRR))])

    def __get_SampEn(self):  # 计算RR间期采样熵,采样数为2
        sampEn = ent.sample_entropy(self.RR_intervals,
                                    2, 0.2 * np.std(self.RR_intervals))
        for i in range(len(sampEn)):
            if np.isnan(sampEn[i]):
                sampEn[i] = -2
            if np.isinf(sampEn[i]):
                sampEn[i] = -1
        return sampEn

    def extract_features(self):  # 提取HRV所有特征
        features = np.concatenate((
            self.__get_sdnn(),
            self.__get_maxRR(),
            self.__get_minRR(),
            self.__get_meanRR(),
            self.__get_Rdensity(),
            self.__get_pNN50(),
            self.__get_RMSSD(),
            self.__get_SampEn(),
        ))
        assert features.shape[0] == ManFeat_HRV.FEAT_DIMENSION
        return features
~~~

### 2.3混合特征

对于每个12导联记录，现在我们得到了12个针对每个导联的深度学习模型，以及相应的人工特征。我们使用12个网络得到12组-9类别softmax概率，我们取前8个概率（由于所有概率相加为1，因此取8个就足够表示），共12*8=96个数值作为特征；加上我们的人工特征9+2=11个（根据参数设定，采样熵最终有两个返回值），得到107维特征。 

### 2.4训练xgboost

```
使用xgboost混合深度学习网络和人工特征，得到最后结果
```

## 3.模型结果

#### 3.1混淆矩阵

#### 3.2AUC，pe+，S

#### 3.3图像

#### 3.4结论

